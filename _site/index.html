<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="http://itsbarakyo.com/css/bootstrap.css" rel="stylesheet">
        <link href="http://itsbarakyo.com/css/syntax.css" rel="stylesheet">
        <script type="text/javascript" src="http://itsbarakyo.com/js/jquery-1.10.2.min.js"></script>
        <script type="text/javascript" src="http://itsbarakyo.com/js/collapse.js"></script>
        <title>itsbarakyo | </title>
    </head>
    <body>
        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#mobile-links">
                      <span class="sr-only">Toggle navigation</span>
                      <span class="glyphicon glyphicon-chevron-down white"></span>
                    </button>
                    <h1>itsbarakyo</h1>
                </div>
            </div>
            <div class="collapse navbar-collapse" id="mobile-links">
                <ul class="nav navbar visible-xs">
                    <li>
                        <a href="http://itsbarakyo.com/" class="btn btn-success btn-lg btn-block">HOME</a>
                    </li>
                    <li>
                        <a href="http://itsbarakyo.com/personal/" class="btn btn-info btn-lg btn-block">PERSONAL</a>
                    </li>
                    <li>
                        <a href="http://itsbarakyo.com/likes/" class="btn btn-like btn-lg btn-block">LIKES</a>
                    </li>
                    <li>
                        <a href="http://itsbarakyo.com/notes/" class="btn btn-warning btn-lg btn-block">NOTES</a>
                    </li>
                    <li>
                        <a href="http://itsbarakyo.com/projects/" class="btn btn-danger btn-lg btn-block">PROJECTS</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="navbar navbar-fixed-top hidden-xs" id="navigation">
            <div class="container">
                <div class="row">
                    <div class="col-sm-12 hidden-xs">
                        <div class="btn-toolbar">
                            <div class="btn-group btn-group-lg">
                                <a href="http://itsbarakyo.com" class="btn btn-success">HOME</a>
                            </div>
                            <div class="btn-group btn-group-lg">
                                <a href="http://itsbarakyo.com/personal/" class="btn btn-info">PERSONAL</a>
                            </div>
                            <div class="btn-group btn-group-lg">
                                <a href="http://itsbarakyo.com/likes/" class="btn btn-like">LIKES</a>
                            </div>
                            <div class="btn-group btn-group-lg">
                                <a href="http://itsbarakyo.com/notes/" class="btn btn-warning">NOTES</a>
                            </div>
                            <div class="btn-group btn-group-lg">
                                <a href="http://itsbarakyo.com/projects/" class="btn btn-danger">PROJECTS</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
<div class="container" id="post-container">
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="projects">
            <p>
                <a href="http://itsbarakyo.com/projects/2015/09/17/elisper-lisp-in-elixir.html">
                    Elisper - Parsing Lisp in Elixir
                </a>
            </p>
            <small>17 Sep 2015</small>
        </blockquote>
        <p><p>I recently read a really interesting and great blog post titled <a href="http://danthedev.com/2015/09/09/lisp-in-your-language/">Lisp in your Language</a> by Dan Prince. The article walked through an implementation of a subset of Lisp. After reading the post, I thought it was a great project to not only have a deeper understanding of Lisp but also of the language that the implementation is in. In fact, I was so inspired by the post, I decided that maybe I&#39;d give it a shot to write it in <a href="https://elixir-lang.org">Elixir</a>.</p>

<p>I&#39;ve been reading and messing around with Elixir for the past month or so. Elixir is a dynamically typed functional programming language built on top of the Erlang VM BEAM. The language is showing a lot of promise and even more interesting it&#39;s built on top of a very scalable platform.</p>

<p>Funny enough, besides syntax, I find Elixir very similar to Clojure (a Lisp dialect implemented on the JVM). If you&#39;re not familiar with Lisps by now, they have a very simple syntax that follows the convention</p>

<div class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nf">fn-name</span> <span class="nv">arg1</span> <span class="nv">arg2</span> <span class="nv">...</span> <span class="nv">argn</span> <span class="p">)</span></code></pre></div>

<p>With introductions out of the way, I&#39;ll try to write this as incrementally as possible. Unfortunately, I didn&#39;t make initial git commits when I was starting out, so some of the initial code is from memory.</p>

<h4>Starting Out</h4>

<p>In the blog post, Prince originally starts out by evaluating a predefined function using Javascript&#39;s <code>fn.apply</code> method. I thought this was a good way to start so I began by doing the same.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">Elisper</span> <span class="k">do</span>
  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">])</span> <span class="k">do</span>
    <span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<p>Similarly to Javascipt, Elixir has an <code>apply/2</code> function which allows you to provide a function name and a list of arguments to pass to that function. The nice thing about function parameters in Elixir is that we can pattern match in them immediately, allowing us to easily pull apart the values in a list and alias them. For the parameter <code>[expr | args]</code>, we&#39;re saying bind the first value (or head) of the list to the name <code>expr</code> and the rest of the list (or tail) to the name <code>args</code> (note that <code>args</code> is also a list).</p>

<p>We can test this out through unit tests:</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">ElisperTest</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="nc">ExUnit.Case</span><span class="p">,</span> <span class="ss">async</span><span class="p">:</span> <span class="no">true</span>

  <span class="n">test</span> <span class="s2">&quot;sum function&quot;</span> <span class="k">do</span>
    <span class="n">sum</span> <span class="p">=</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span>
    <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">([</span><span class="n">sum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">3</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<p>In our first unit test, we&#39;re creating an anonymous function <code>sum</code> which we&#39;re passing to our <code>eval</code> function with the arguments 1 and 2. Note that for pattern matching our <code>expr</code> value would be the function <code>sum</code> and the <code>args</code> parameter would take the value <code>[1,2]</code>. Let&#39;s run our test and see what we get...</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">[~/D/elisper|ruby-2.2.3]
$ mix test lib/elisper.ex:8                                                    0|11:22:59
Including tags: [line: &quot;8&quot;]
Excluding tags: [:test]



Finished in 0.04 seconds (0.04s on load, 0.00s on tests)
0 tests, 0 failures

Randomized with seed 560288
</code></pre></div>
<h4>Mathematical and Native Operations</h4>

<p>The next step in Dan&#39;s article is the ability to pass arithmetic functions such as plus, minus, division, subtraction, etc. Dan accomplishes this by creating a Javascript object which he uses the passed in string as a key in the object&#39;s properties. We can follow a similar example in Elixir using Maps and atoms for cleaner syntax. Originally I was hoping to be able to pass in the already defined arithmetic functions in Elixir such as <code>Kernal.+/2</code> but I was unsuccessful in passing the function without it being evaluated. Our syntax for evaluating our &quot;native&quot; functions will be using atoms. Let&#39;s start by writing a test to show how this would look.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">ElisperTest</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="nc">ExUnit.Case</span><span class="p">,</span> <span class="ss">async</span><span class="p">:</span> <span class="no">true</span>

  <span class="n">test</span> <span class="s2">&quot;sum function&quot;</span> <span class="k">do</span>
    <span class="n">sum</span> <span class="p">=</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span>
    <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">([</span><span class="n">sum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">3</span>
  <span class="k">end</span>

  <span class="n">test</span> <span class="s2">&quot;native addition function&quot;</span> <span class="k">do</span>
    <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">([</span><span class="ss">:+</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">3</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<p>You can see that from the new test the arguments to our eval function is now a list containing an atom <code>:+</code> to represent our native addition function with the same arguments 1 and 2. Let&#39;s update our implementation to support these native functions.</p>

<p>We&#39;ll start by defining a new eval function using a guard statement. A guard statement allows us to define a function that will only be called when a set of conditions are true. In this case, we want to create an <code>eval</code> that will be called when we pass an <code>atom</code> as the head of the list. In this function we&#39;ll define our <code>native_ops</code> map which will be a map containing a list of our native arithmetic functions.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">Elisper</span> <span class="k">do</span>
  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">]</span> <span class="p">=</span> <span class="n">expression</span><span class="p">)</span> <span class="ow">when</span> <span class="n">is_atom</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">native_ops</span> <span class="p">=</span> <span class="p">%{</span>
      <span class="ss">+</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">-</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">*</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">/</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="p">=</span><span class="err">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="k">end</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="nc">Map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">native_ops</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
      <span class="no">nil</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
      <span class="n">func</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">([</span><span class="n">func</span><span class="p">]</span> <span class="o">++</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">])</span> <span class="k">do</span>
    <span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<p>Let&#39;s run our tests to verify that what we&#39;ve done works correctly:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ mix test test/elisper_test.exs                                              0|13:54:00
..

Finished in 0.03 seconds (0.03s on load, 0.00s on tests)
2 tests, 0 failures

Randomized with seed 398982
</code></pre></div>
<h4>Handling Nested Expressions</h4>

<p>The next thing we want to do is handle nested arguments. Lisps can evaluate nested expressions in the form:</p>

<div class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">1</span><span class="p">))</span></code></pre></div>

<p>We want to be able to handle the same expressions. Since we already have an idea of what we want to test, let&#39;s start by again writing our tests first.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">ElisperTest</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="nc">ExUnit.Case</span><span class="p">,</span> <span class="ss">async</span><span class="p">:</span> <span class="no">true</span>

  <span class="n">test</span> <span class="s2">&quot;sum function&quot;</span> <span class="k">do</span>
    <span class="n">sum</span> <span class="p">=</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span>
    <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">([</span><span class="n">sum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">3</span>
  <span class="k">end</span>

  <span class="n">test</span> <span class="s2">&quot;native addition function&quot;</span> <span class="k">do</span>
    <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">([</span><span class="ss">:+</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">3</span>
  <span class="k">end</span>

  <span class="n">test</span> <span class="s2">&quot;two recursive arguments&quot;</span> <span class="k">do</span>
    <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">([</span><span class="ss">:+</span><span class="p">,</span> <span class="p">[</span><span class="ss">:+</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="ss">:+</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]))</span> <span class="o">==</span> <span class="mi">4</span>
 <span class="k">end</span>

<span class="k">end</span></code></pre></div>

<p>Before attempting the implementation for evaluating nested arguments. I&#39;d like to explain the solution that I took. Before evaluating the function and its arguments in our <code>eval</code> function that calls <code>apply/2</code>, we could iterate through the list of values and determine if a list exists. If one of the values is a list, we can recursively call eval, which will format and evaluate the nested expression. Let&#39;s see what that looks like:</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">Elisper</span> <span class="k">do</span>
  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">]</span> <span class="p">=</span> <span class="n">expression</span><span class="p">)</span> <span class="ow">when</span> <span class="n">is_atom</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">native_ops</span> <span class="p">=</span> <span class="p">%{</span>
      <span class="ss">+</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">-</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">*</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">/</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="p">=</span><span class="err">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="k">end</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="nc">Map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">native_ops</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
      <span class="no">nil</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
      <span class="n">func</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">([</span><span class="n">func</span><span class="p">]</span> <span class="o">++</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">])</span> <span class="k">do</span>
    <span class="n">sub_exprs</span> <span class="p">=</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="k">fn</span>
      <span class="p">([</span><span class="n">_h</span> <span class="p">|</span> <span class="n">_t</span><span class="p">]</span> <span class="p">=</span> <span class="n">arg</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
      <span class="n">arg</span> <span class="p">-&gt;</span> <span class="n">arg</span>
    <span class="k">end</span><span class="p">)</span>
    <span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">sub_exprs</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<p>Lets break this down piece by piece. First we start out by enumerating over all of our arguments using <code>Enum.map</code>. As people are familiar with <code>map</code> functions in other languages, they accept a collection to iterate through and a function to apply to each argument. In this case we&#39;ve created an anonymous function that has two bodies. An awesome feature about Elixir is that anonymous functions can pattern match and have multiple bodies allowing us to handle different input. In this case, we want to specifically handle two inputs, one where the value is a list and when the supplied argument is just a single value. By pattern matching on an item with a head and tail, we can match against lists and as we&#39;ve stated before, recursively call eval on our list. If the supplied argument is just a value, we simply want to return it. Once we&#39;ve completed enumerating through and evaluating all of the arguments, we can finally call <code>apply/2</code> with our original <code>expr</code> and the newly evaluated <code>sub_exprs</code>.</p>

<h4>Conditionals</h4>

<p>One of the many features we use while programming is conditionals. To make some interesting expressions, let&#39;s add support for conditionals into our implementation. Conditionals in the Lisps take the form:</p>

<div class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">conditional</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">true</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">false</span><span class="p">)</span>
<span class="p">)</span></code></pre></div>

<p>We can define a simple conditional using the test:</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="n">test</span> <span class="s2">&quot;if clause&quot;</span> <span class="k">do</span>
  <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">([</span><span class="ss">:if</span><span class="p">,</span> <span class="p">[</span><span class="err">:</span><span class="p">=,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="ss">:+</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="ss">:+</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]))</span> <span class="o">==</span> <span class="mi">2</span>
<span class="k">end</span></code></pre></div>

<p>We can handle the case for <code>if</code> within our <code>native_ops</code> map. Within <code>native_ops</code>  we can simply define a function for the if key that accepts 3 arguements, a <code>conditional</code>, the <code>first</code> (or true) clause, and the <code>second</code> (or false) clause. From there we can simply evaluate our <code>conditional</code> that is passed to our function. As you may have guessed, if <code>conditional</code> evaluates to true, we simply return <code>first</code>, else we return <code>second</code>.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">Elisper</span> <span class="k">do</span>
  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">]</span> <span class="p">=</span> <span class="n">expression</span><span class="p">)</span> <span class="ow">when</span> <span class="n">is_atom</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">native_ops</span> <span class="p">=</span> <span class="p">%{</span>
      <span class="ss">+</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">-</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">*</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">/</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="p">=</span><span class="err">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">if</span><span class="p">:</span> <span class="k">fn</span><span class="p">(</span><span class="n">conditional</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="k">if</span><span class="p">(</span><span class="n">conditional</span><span class="p">)</span> <span class="k">do</span> <span class="n">first</span> <span class="k">else</span> <span class="n">second</span> <span class="k">end</span> <span class="k">end</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="nc">Map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">native_ops</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
      <span class="no">nil</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
      <span class="n">func</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">([</span><span class="n">func</span><span class="p">]</span> <span class="o">++</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">])</span> <span class="k">do</span>
    <span class="n">sub_exprs</span> <span class="p">=</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="k">fn</span>
      <span class="p">([</span><span class="n">_h</span> <span class="p">|</span> <span class="n">_t</span><span class="p">]</span> <span class="p">=</span> <span class="n">arg</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
      <span class="n">arg</span> <span class="p">-&gt;</span> <span class="n">arg</span>
    <span class="k">end</span><span class="p">)</span>
    <span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">sub_exprs</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<h4>Binding Values</h4>

<p>One of the harder things that I came across was the ability to define values. Values in Lisps are bound using the <code>def</code> expression. These bound values are immutable and cannot be changed. Let&#39;s take a look at what an expression would look like:</p>

<div class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="k">def </span><span class="nv">a</span> <span class="mi">5</span><span class="p">)</span></code></pre></div>

<p>Doing so allows us to use these values in other contexts like:</p>

<div class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nf">do</span>
  <span class="p">(</span><span class="k">def </span><span class="nv">a</span> <span class="mi">5</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">a</span><span class="p">)</span>
<span class="p">)</span></code></pre></div>

<p>At this point, we have an idea for our next test and we also know what we want to implement, <code>do</code> and <code>def</code> expressions.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">ElisperTest</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="nc">ExUnit.Case</span><span class="p">,</span> <span class="ss">async</span><span class="p">:</span> <span class="no">true</span>

  <span class="n">test</span> <span class="s2">&quot;sum function&quot;</span> <span class="k">do</span>
    <span class="n">sum</span> <span class="p">=</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span>
    <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">([</span><span class="n">sum</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">3</span>
  <span class="k">end</span>

  <span class="n">test</span> <span class="s2">&quot;native addition function&quot;</span> <span class="k">do</span>
    <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">([</span><span class="ss">:+</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">3</span>
  <span class="k">end</span>

  <span class="n">test</span> <span class="s2">&quot;two recursive arguments&quot;</span> <span class="k">do</span>
    <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">([</span><span class="ss">:+</span><span class="p">,</span> <span class="p">[</span><span class="ss">:+</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="ss">:+</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]))</span> <span class="o">==</span> <span class="mi">4</span>
 <span class="k">end</span>

 <span class="n">test</span> <span class="s2">&quot;def&quot;</span> <span class="k">do</span>
   <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">([</span><span class="ss">:do</span><span class="p">,</span> <span class="p">[</span><span class="ss">:def</span><span class="p">,</span> <span class="ss">:a</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="ss">:+</span><span class="p">,</span> <span class="ss">:a</span><span class="p">,</span> <span class="ss">:a</span><span class="p">]]))</span> <span class="o">==</span> <span class="mi">10</span>
 <span class="k">end</span>

<span class="k">end</span></code></pre></div>

<p>Now that we have our tests defined, we need to review what our implementation may look like. After trying out a number of options, I decided the best way to handle <code>def</code> clauses was to treat them separately before evaluating any expressions. I would iterate through the passed in arguments and define a <code>scope</code> which could be carried through evaluation that would hold all of the bounded values from the <code>def</code> clauses. Some of our steps:</p>

<ul>
<li>Update existing <code>eval</code> functions to accept a second <code>scope</code> parameter.</li>
<li>Implement a new <code>eval</code> function that accepts only one parameter (the expression to evaluate) where the default scope is an empty scope.</li>
<li>Before calling our <code>eval/2</code> functions, we&#39;ll update our scope with all the bounded variables to pass to our lower <code>eval/2</code> functions.</li>
<li>Handle our <code>def</code> and <code>do</code> functions.</li>
<li>Replace any instances of our variables with their bounded values.</li>
</ul>

<p><strong>Step 1:</strong> Update existing functions and define new <code>eval/1</code> function.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">Elisper</span> <span class="k">do</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">]</span> <span class="p">=</span> <span class="n">expression</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span> <span class="ow">when</span> <span class="n">is_atom</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">native_ops</span> <span class="p">=</span> <span class="p">%{</span>
      <span class="ss">+</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">-</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">*</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">/</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="p">=</span><span class="err">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">if</span><span class="p">:</span> <span class="k">fn</span><span class="p">(</span><span class="n">conditional</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="k">if</span><span class="p">(</span><span class="n">conditional</span><span class="p">)</span> <span class="k">do</span> <span class="n">first</span> <span class="k">else</span> <span class="n">second</span> <span class="k">end</span> <span class="k">end</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="nc">Map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">native_ops</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
      <span class="no">nil</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
      <span class="n">func</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">([</span><span class="n">func</span><span class="p">]</span> <span class="o">++</span> <span class="n">args</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">],</span> <span class="n">scope</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">sub_exprs</span> <span class="p">=</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="k">fn</span>
      <span class="p">([</span><span class="n">_h</span> <span class="p">|</span> <span class="n">_t</span><span class="p">]</span> <span class="p">=</span> <span class="n">arg</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
      <span class="n">arg</span> <span class="p">-&gt;</span> <span class="n">arg</span>
    <span class="k">end</span><span class="p">)</span>
    <span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">sub_exprs</span><span class="p">)</span>
  <span class="k">end</span>

<span class="k">end</span></code></pre></div>

<p><strong>Step 2:</strong> Define new <code>eval/1</code> function.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">Elisper</span> <span class="k">do</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="p">%{})</span>
  <span class="k">end</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">]</span> <span class="p">=</span> <span class="n">expression</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span> <span class="ow">when</span> <span class="n">is_atom</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">native_ops</span> <span class="p">=</span> <span class="p">%{</span>
      <span class="ss">+</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">-</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">*</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">/</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="p">=</span><span class="err">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">if</span><span class="p">:</span> <span class="k">fn</span><span class="p">(</span><span class="n">conditional</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="k">if</span><span class="p">(</span><span class="n">conditional</span><span class="p">)</span> <span class="k">do</span> <span class="n">first</span> <span class="k">else</span> <span class="n">second</span> <span class="k">end</span> <span class="k">end</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="nc">Map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">native_ops</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
      <span class="no">nil</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
      <span class="n">func</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">([</span><span class="n">func</span><span class="p">]</span> <span class="o">++</span> <span class="n">args</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">],</span> <span class="n">scope</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">sub_exprs</span> <span class="p">=</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="k">fn</span>
      <span class="p">([</span><span class="n">_h</span> <span class="p">|</span> <span class="n">_t</span><span class="p">]</span> <span class="p">=</span> <span class="n">arg</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
      <span class="n">arg</span> <span class="p">-&gt;</span> <span class="n">arg</span>
    <span class="k">end</span><span class="p">)</span>
    <span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">sub_exprs</span><span class="p">)</span>
  <span class="k">end</span></code></pre></div>

<p><strong>Step 3:</strong> In step 3, we iterate through <code>expr</code> but this time we use the <code>reduce</code> function to output a map which contains the values bounded by the <code>def</code> expressions. We can once again use pattern matching to make our anonymous function more concise. Our first case, where we match the head of the list to <code>:def</code> we know to return a new map with our new value. In the case that we don&#39;t find a match, simply return the existing map.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">Elisper</span> <span class="k">do</span>
  <span class="kd">def</span> <span class="n">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">scope</span> <span class="p">=</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="p">%{},</span> <span class="k">fn</span>
      <span class="p">([</span><span class="ss">:def</span> <span class="p">|</span> <span class="n">arg</span><span class="p">],</span> <span class="n">acc</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nc">Map</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="nc">List</span><span class="p">.</span><span class="n">first</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="nc">List</span><span class="p">.</span><span class="n">last</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
      <span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">acc</span>
    <span class="k">end</span><span class="p">)</span>
    <span class="n">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">]</span> <span class="p">=</span> <span class="n">expression</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span> <span class="ow">when</span> <span class="n">is_atom</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">native_ops</span> <span class="p">=</span> <span class="p">%{</span>
      <span class="ss">+</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">-</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">*</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">/</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="p">=</span><span class="err">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">if</span><span class="p">:</span> <span class="k">fn</span><span class="p">(</span><span class="n">conditional</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="k">if</span><span class="p">(</span><span class="n">conditional</span><span class="p">)</span> <span class="k">do</span> <span class="n">first</span> <span class="k">else</span> <span class="n">second</span> <span class="k">end</span> <span class="k">end</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="nc">Map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">native_ops</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
      <span class="no">nil</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
      <span class="n">func</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">([</span><span class="n">func</span><span class="p">]</span> <span class="o">++</span> <span class="n">args</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">],</span> <span class="n">scope</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">sub_exprs</span> <span class="p">=</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="k">fn</span>
      <span class="p">([</span><span class="n">_h</span> <span class="p">|</span> <span class="n">_t</span><span class="p">]</span> <span class="p">=</span> <span class="n">arg</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
      <span class="n">arg</span> <span class="p">-&gt;</span> <span class="n">arg</span>
    <span class="k">end</span><span class="p">)</span>
    <span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">sub_exprs</span><span class="p">)</span>
  <span class="k">end</span>

<span class="k">end</span></code></pre></div>

<p><strong>Step 4:</strong> Handling the <code>def</code> and <code>do</code> expressions during evaluation.
Our <code>def</code> and <code>do</code> functions are a little weird and we&#39;ll have to handle them both a little differently than our arithmetic functions. In the case of <code>do</code>, we need to take a step back and think about what the function actually does. According to the <a href="https://clojuredocs.org/clojure.core/do">Clojure Docs</a> on <code>do</code>:</p>

<blockquote>
<p>Evaluates the expressions in order and returns the value of the last. If no
expressions are supplied, returns nil.</p>
</blockquote>

<p>Following the documentation, we can simply define a function for <code>do</code> which returns the last argument that has been passed to it, that&#39;s simple enough. In the case of <code>def</code>, since we&#39;ve already handled it&#39;s purpose by binding the value to its alias within the scope, we can simply ignore it during evaluation.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">Elisper</span> <span class="k">do</span>
  <span class="kd">def</span> <span class="n">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">scope</span> <span class="p">=</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="p">%{},</span> <span class="k">fn</span>
      <span class="p">([</span><span class="ss">:def</span> <span class="p">|</span> <span class="n">arg</span><span class="p">],</span> <span class="n">acc</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nc">Map</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="nc">List</span><span class="p">.</span><span class="n">first</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="nc">List</span><span class="p">.</span><span class="n">last</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
      <span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">acc</span>
    <span class="k">end</span><span class="p">)</span>
    <span class="n">eval</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">]</span> <span class="p">=</span> <span class="n">expression</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span> <span class="ow">when</span> <span class="n">is_atom</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">native_ops</span> <span class="p">=</span> <span class="p">%{</span>
      <span class="ss">+</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">-</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">*</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">/</span><span class="p">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="p">=</span><span class="err">:</span> <span class="k">fn</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">if</span><span class="p">:</span> <span class="k">fn</span><span class="p">(</span><span class="n">conditional</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="k">if</span><span class="p">(</span><span class="n">conditional</span><span class="p">)</span> <span class="k">do</span> <span class="n">first</span> <span class="k">else</span> <span class="n">second</span> <span class="k">end</span> <span class="k">end</span><span class="p">,</span>
      <span class="ss">do</span><span class="p">:</span> <span class="k">fn</span><span class="p">(</span><span class="n">_a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">b</span> <span class="k">end</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="nc">Map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">native_ops</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
      <span class="no">nil</span> <span class="p">-&gt;</span> <span class="p">(</span>
        <span class="k">if</span> <span class="n">expr</span> <span class="o">==</span> <span class="ss">:def</span> <span class="k">do</span>
          <span class="ss">:ok</span>
        <span class="k">else</span>
          <span class="n">eval</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
        <span class="k">end</span>
      <span class="p">)</span>
      <span class="n">func</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">([</span><span class="n">func</span><span class="p">]</span> <span class="o">++</span> <span class="n">args</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kd">def</span> <span class="n">eval</span><span class="p">([</span><span class="n">expr</span> <span class="p">|</span> <span class="n">args</span><span class="p">],</span> <span class="n">scope</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">sub_exprs</span> <span class="p">=</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="k">fn</span>
      <span class="p">([</span><span class="n">_h</span> <span class="p">|</span> <span class="n">_t</span><span class="p">]</span> <span class="p">=</span> <span class="n">arg</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
      <span class="n">arg</span> <span class="p">-&gt;</span> <span class="p">(</span>
        <span class="k">case</span> <span class="nc">Map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span> <span class="k">do</span>
          <span class="no">nil</span> <span class="p">-&gt;</span> <span class="n">arg</span>
          <span class="n">x</span> <span class="p">-&gt;</span> <span class="n">x</span>
        <span class="k">end</span>
      <span class="p">)</span>
    <span class="k">end</span><span class="p">)</span>
    <span class="n">apply</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">sub_exprs</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<h4>Defining Functions</h4>

<p>For our last section, we&#39;ll cover how to define functions. We&#39;ll use the following syntax provided by Dan&#39;s article for defining a function:</p>

<div class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="k">def </span><span class="nv">fn-name</span>
  <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">args</span><span class="p">]</span> <span class="p">(</span><span class="nf">body</span><span class="p">))</span>
<span class="p">)</span></code></pre></div>

<p>Using this syntax, functions must be defined with <code>def</code>, this may give you a hint as to where we&#39;ll need to add it in the implementation. Similar to other <code>def</code> expressions, we&#39;ll want to be able to add our function information to the scope, so that it can be used throughout the evaluation of the rest of the expressions. Functions are a slightly different case of the <code>def</code> expression that we have, so we&#39;ll need to take that into account. Before jumping into the implementation, let&#39;s write another test.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="n">test</span> <span class="s2">&quot;def fn&quot;</span> <span class="k">do</span>
 <span class="n">assert</span> <span class="p">(</span><span class="nc">Elisper</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span>
    <span class="p">[</span><span class="ss">:do</span><span class="p">,</span>
     <span class="p">[</span><span class="ss">:def</span><span class="p">,</span> <span class="ss">:multi</span><span class="p">,</span>
       <span class="p">[</span><span class="ss">:fn</span><span class="p">,</span> <span class="p">[</span><span class="ss">:x</span><span class="p">,</span> <span class="ss">:y</span><span class="p">],</span>
         <span class="p">[</span><span class="ss">:*</span><span class="p">,</span> <span class="ss">:x</span><span class="p">,</span> <span class="ss">:y</span><span class="p">]</span>
       <span class="p">]</span>
     <span class="p">],</span>
     <span class="p">[</span><span class="ss">:multi</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="p">]</span>
  <span class="p">))</span> <span class="o">==</span> <span class="mi">12</span>
<span class="k">end</span></code></pre></div>

<p>One more thing to think about before we begin the implementation is how we want to add function information to our scope. I chose to create a map containing a <code>params</code> key and a <code>body</code> key to store the params and body of the function, respectively. After updating our scope should look similar to:</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="p">%{</span>
  <span class="ss">params</span><span class="p">:</span> <span class="p">[</span><span class="ss">:x</span><span class="p">,</span> <span class="ss">:y</span><span class="p">],</span>
  <span class="ss">body</span><span class="p">:</span>   <span class="p">[</span><span class="ss">:*</span><span class="p">,</span> <span class="ss">:x</span><span class="p">,</span> <span class="ss">:y</span><span class="p">]</span>
<span class="p">}</span></code></pre></div>

<p>Now that we have an idea of what we want to implement, let&#39;s go back to our <code>Enum.reduce</code> function.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="n">scope</span> <span class="p">=</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="p">%{},</span> <span class="k">fn</span>
  <span class="p">([</span><span class="ss">:def</span> <span class="p">|</span> <span class="n">arg</span><span class="p">],</span> <span class="n">acc</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nc">Map</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="nc">List</span><span class="p">.</span><span class="n">first</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="nc">List</span><span class="p">.</span><span class="n">last</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
  <span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">acc</span>
<span class="k">end</span><span class="p">)</span></code></pre></div>

<p>As we stated before, we&#39;ll want to add a case to match, we know that we still want to match for on <code>def</code> as the head of the list, but what about the tail? The tail of our list has the format <code>[fn-name, [:fn, [params], [body]]]</code>. The great thing is that we can pattern match to exactly that format. Since we&#39;ve extracted the values from the list, we can easily add a new map to the scope.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="n">scope</span> <span class="p">=</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="p">%{},</span> <span class="k">fn</span>
  <span class="p">([</span><span class="ss">:def</span> <span class="p">|</span> <span class="p">[</span><span class="n">func_name</span><span class="p">,</span> <span class="p">[</span><span class="ss">:fn</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">body</span><span class="p">]]],</span> <span class="n">acc</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="p">(</span>
    <span class="nc">Map</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">func_name</span><span class="p">,</span> <span class="p">%{</span><span class="ss">params</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span> <span class="ss">body</span><span class="p">:</span> <span class="n">body</span><span class="p">})</span>
  <span class="p">)</span>
  <span class="p">([</span><span class="ss">:def</span> <span class="p">|</span> <span class="n">arg</span><span class="p">],</span> <span class="n">acc</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nc">Map</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="nc">List</span><span class="p">.</span><span class="n">first</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="nc">List</span><span class="p">.</span><span class="n">last</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
  <span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">acc</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">acc</span>
<span class="k">end</span><span class="p">)</span></code></pre></div>

<p>The next thing we&#39;ll want to do, is handle what to do when we come across <code>:fn</code> and our user created functions during evaluation. This hapens in the <code>nil</code> case when we lookup function replacements from our <code>native_ops</code> map. We&#39;ll have to modify the <code>nil</code> case a bit to get our desired behavior. First, we&#39;ll want to update our conditional to also return <code>:ok</code> when we come across a <code>:fn</code> value in our list of expressions. The next thing we&#39;ll want to do, is see if the <code>expr</code> is defined in our scope and if it is, evaluate the function with the correct parameters. Let&#39;s see what this looks like:</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="k">case</span> <span class="nc">Map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">native_ops</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
  <span class="no">nil</span> <span class="p">-&gt;</span> <span class="p">(</span>
    <span class="k">if</span> <span class="n">expr</span> <span class="o">==</span> <span class="ss">:def</span> <span class="o">||</span> <span class="n">expr</span> <span class="o">==</span> <span class="ss">:fn</span> <span class="k">do</span>
      <span class="ss">:ok</span>
    <span class="k">else</span>
      <span class="k">case</span> <span class="nc">Map</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span> <span class="k">do</span>
        <span class="p">%{</span><span class="ss">body</span><span class="p">:</span> <span class="n">body</span><span class="p">,</span> <span class="ss">params</span><span class="p">:</span> <span class="n">params</span><span class="p">}</span> <span class="p">-&gt;</span> <span class="p">(</span>
          <span class="n">new_scope</span> <span class="p">=</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">zip</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
            <span class="o">|&gt;</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="k">fn</span><span class="p">({</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">},</span> <span class="n">acc</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nc">Map</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">end</span><span class="p">)</span>
          <span class="n">eval</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">new_scope</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="no">nil</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="p">)</span>
  <span class="n">func</span> <span class="p">-&gt;</span> <span class="n">eval</span><span class="p">([</span><span class="n">func</span><span class="p">]</span> <span class="o">++</span> <span class="n">args</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
<span class="k">end</span></code></pre></div>

<p>Using the <code>Map.get</code> function we&#39;ll lookup the <code>expr</code> in our <code>scope</code>. If a case matches the pattern, <code>%{body: body, params: params}</code>, that we defined for our function entries, we need to evaluate the user defined function. Before simply passing the <code>body</code> to our <code>eval</code> function, we&#39;ll need to update our <code>scope</code> with the new values. To do so, we&#39;ll first use <code>Enum.zip</code> to create a list of tuples containing the parameter name and the value associated with it. In the case of our test, our zipped list would look something like: <code>[{:x, 3}, {:y, 4}]</code>. Using this list we can once again use <code>Enum.reduce</code> to create a new scope that adds the key/value pair of the tuple to our existing scope. Using our new scope, so cleverly titled <code>new_scope</code>, and our <code>body</code> to finally evaluate the expression.</p>

<p>We can now re-run all of our tests:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">mix test test/elisper_test.exs                                              0|10:06:43
......

Finished in 0.04 seconds (0.04s on load, 0.00s on tests)
6 tests, 0 failures

Randomized with seed 969698
</code></pre></div>
<h4>Conclusion</h4>

<p>I hope that you enjoyed this blog post and maybe I&#39;ve peaked your interest to take a look into Elixir. I&#39;ve put the code on <a href="https://github.com/barakyo/elisper">Github</a> to mess around with. Pull requests are welcomed if you want to mess around and add features or clean up the code for me to learn from. :)</p>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="personal">
            <p>
                <a href="http://itsbarakyo.com/personal/2015/02/01/resolutions-one-month-review.html">
                    2015 Resolutions - 1 Month Review
                </a>
            </p>
            <small>01 Feb 2015</small>
        </blockquote>
        <p><p>Wow! I can&#39;t believe it&#39;s February already! As I stated in my New Year Resolutions post, I wrote down my resolutions so that I could be held accountable for them. Reviewing my resolutions after a year seemed like I would easily lose touch/sight of them. I decided a good idea would be to review my progress month-by-month, so here it goes:</p>

<h4>Read more (and not programming/technical books)</h4>

<p>I believe I&#39;ve been doing a good job of this! My previous post was a review on Ready Player One, which was a fantastic book. I&#39;m still reading technical books (<a href="http://www.manning.com/rathore/">Clojure In Actions</a>) As I&#39;ve taking a liking to Clojure, but I&#39;m still making time for other books as well. A close friend of mine recommended reading <a href="http://www.amazon.com/Outliers-Story-Success-Malcolm-Gladwell/dp/0316017930">Outliers: The Story of Success by Martin Gladwell</a>. From what he&#39;s told me, the book sounds incredibly interesting and very motivational. I hope to begin reading this as soon as tomorrow night (02/02/15), so keep an eye out for that review!</p>

<h4>Continue to shoot (photograph) more often and update my blog with some of my favorite pictures!</h4>

<p>I&#39;ve been shooting and posting my favorite pictures to my <a href="http://instagram.com/barakyoo">Instagram</a>, but I haven&#39;t done a good job of posting the pictures to my blog. Be ready for an influx of pictures soon. I&#39;m not sure if I just want to have one post/picture or if I want to setup a sort of gallery. Regardless, release fast and release often, so I&#39;ll have some pictures up this week. I do have a couple of shots that I have in mind and I&#39;d like to be able to get more pictures of activities with my friends, so I&#39;ll hopefully put those in motion this month!</p>

<h4>Graduate and complete my M.S. in Computer Science!</h4>

<p>I&#39;ve enrolled in my final thesis class, which is a step forward towards the path of graduation. I have to proof-read my thesis and practice my defense.</p>

<h4>Try to really help one person a week.</h4>

<p>I don&#39;t know how much I&#39;ve been sticking to this one and it&#39;s probably the thing that bothers me the most. I feel like lately my friends have been helping me out a lot lately, but I don&#39;t know if I&#39;m recipricating that back to them or towards other people. I don&#39;t exactly have a plan for this one, but hopefully I can put something together soon.</p>

<h4>Talk to/meet new people.</h4>

<p>I also feel that I&#39;ve been dropping the ball on this. This may partially be due to me getting a new phone (and wanting to play around with it), but also just me shying away in general.</p>

<h4>Continue to swim at least 3x/week!</h4>

<p>I think if there is one resolution I&#39;ve excelled at, it&#39;s been this one. Since Christmas, I&#39;ve been swimming about 5x/week and exercising 6x/week. I&#39;ve been attending Masters workouts at least once a week. I feel that my swim game has been improving tremendously. My strokes still need a lot of work, but they&#39;re getting better! Despite my hardwork, I have a plan to improve. Masters workouts are hard for me to make since they&#39;re right in the middle of the day (12-1) and having to get there early, then eat lunch, and go back to work, I lose a big chunk of my day which is why I&#39;ve only been going once a week. I plan to start attending the 6AM-7AM swim workouts, that way I can get my workout out of the way early in the morning and be available for my team/coworkers when it counts!</p>

<p>To summarize, the things I need to work on for the month of February:</p>

<ul>
<li>Read Outliers (and learn Clojure :P)</li>
<li>Post my favorite pictures here</li>
<li>Proofread my thesis and practice my defense</li>
<li>Figure out a plan to help people</li>
<li>Get off my phone when I&#39;m out alone</li>
<li>Start swimming the morning masters workouts</li>
</ul>

<p>Accountability.</p>

<p>One last thing, I realized my &quot;talk to/meet new people&quot; and &quot;try to really help one person a week&quot; goals aren&#39;t <a href="http://en.wikipedia.org/wiki/SMART_criteria">SMART goals</a> which may be why they&#39;re so difficult to identify. Maybe my plan for achieving these resolutions should be to identify them as SMART goals and then execute.</p>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="likes">
            <p>
                <a href="http://itsbarakyo.com/likes/2015/01/28/review-ready-player-one.html">
                    Review: Ready Player One
                </a>
            </p>
            <small>28 Jan 2015</small>
        </blockquote>
        <p><p><img src="https://encrypted.google.com/books/content/images/frontcover/FY_HWAcm10MC?fife=w300-rw" alt="Ready Player One"></p>

<p>With keeping up on my new year resolutions, the first book of 2015 that I decided to read was <a href="https://play.google.com/store/books/details/Ernest_Cline_Ready_Player_One?id=FY_HWAcm10MC">Ready Player One</a> by Ernest Cline. I found the book browsing through Barnes and Nobles and realized it was surprisingly cheap on the Google Play Bookstore (sorry local Barnes and Nobles, have to justify my Nexus 7 purchase somehow).</p>

<p>I have to say that I hope the rest of the books I read this year are this good. It may be a cliche, but I could not put this book down. I was seriously trying to only read a little bit at a time, but everytime I&#39;d sit down to read, I&#39;d get carried away. With each chapter, I just wanted to keep digging deeper and deeper.</p>

<p>Ready Player One follows the virtual and real life of Walter Wade as he uncovers the mysterious Easter Egg left in the virtual world OASIS left by the creator. The book starts off the adventure from Wade&#39;s early years growing up in the outskirts of Oklahoma City in project-like structures called stacks. As many people need an escape, Walter finds his in the OASIS. A virtual reality world which originally started off as an insane MMORPG. Society later realized how valuable the OASIS which lead to its popularity.</p>

<p>Ready Player One is a roller coaster ride adventure with great references to 80&#39;s video game, movie, and music culture. If you love playing Pacman, 80&#39;s musics or television, or video games in general, you <strong>CANNOT</strong> pass on this book.</p>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="personal">
            <p>
                <a href="http://itsbarakyo.com/personal/2014/12/31/new-year-resolutions.html">
                    New Year Resolutions
                </a>
            </p>
            <small>31 Dec 2014</small>
        </blockquote>
        <p><p>Well I hope I&#39;m not too late to get my new year resolutions in. I&#39;ve been thinking about this post for a while, but was only finally inspired after my last cup of coffee of 2014. In fact, this day included a lot of lasts. The last swim of the year, the last time I&#39;d visit my brother in 2014, the last time I&#39;d accidentally cut myself in 2014 (I hope), the last..well, I think we all get it. In all seriousness, I don&#39;t usually subscribe to the new year resolution thing, I believe that if you want to change something about your life or self, why wait? But, I also understand the nice things of having a clean slate. In addition, new year resolutions are slightly cliche, but I believe that writing them down will force some accountability. I&#39;d like to review them a year from now and see reflect on how much I&#39;ve kept to them.</p>

<p>Anyways, enough jibber jabber, below are my new year resolutions:</p>

<ul>
<li>Read more (and not programming/technical books)</li>
<li>Continue to shoot (photograph) more often and update my blog with some of my favorite pictures!</li>
<li>Graduate and complete my M.S. in Computer Science! My thesis is complete, I need to practice defending it and actually defend!</li>
<li>Try to really help one person a week. I don&#39;t mean holding the door open or letting them in, I mean really help someone.</li>
<li>Talk to/meet new people. Ideally, one new person a day. (I&#39;ll elaborate on this further down)</li>
<li>Continue to swim at least 3x/week! In addition, participate in masters swimming classes as much as possible!</li>
</ul>

<p>To elaborate on the point about talking to and meeting new people, it has to do with me noticing that when I&#39;m somewhere, typically alone, I tend to shy off (into my phone) to not really have to interact with people I don&#39;t know. I&#39;d like to work on breaking that kind of awkward barrier when either waiting around for a cup of coffee or something of that nature.</p>

<p>May everyone have a happy and safe new year! Let&#39;s leave the bad in 2014 and only take the best moments and continue them forward.</p>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="personal">
            <p>
                <a href="http://itsbarakyo.com/personal/2014/10/02/25-years-5-months-14-days.html">
                    25 Years, 5 Months, and 14 days
                </a>
            </p>
            <small>02 Oct 2014</small>
        </blockquote>
        <p><p>Today I am 25 years, 5 months, and 14 days old, the exact same age my brother was when he passed away. This day has been on my mind everyday for the past year. I&#39;ve spent long car rides, sleepness nights, and countless laps swimming thinking about today, asking my self what should I do, what should I say. After wrestling with my thoughts, I thought it may be best to write out my thoughts and reflect.</p>

<p>My brother, Harel, had an incredible abillity to touch everyone that he came in contact with. I remember when I was younger it felt like he knew everyone. There was not a place I would go with my brother where we wouldn&#39;t randomly bump into someone he knew. Even more so, the respect and excitement that was shown to my brother by everyone around him was incredible. When my brother would walk into a room, it was as if all the attention just shifted to him and regardless of what the mood was before, it immediately got better.</p>

<p>Despite many of the hardships my brother had growing up, from not having much growing up to <a href="http://articles.latimes.com/1995-06-12/local/me-12368_1_taft-high-school-student">losing friends as a teenager</a>, he had this incredible ability to flip a situation and look at the bright side. He was always positive and knew how to make the best of any situation. His smile was contagious, his stories were great, and just hearing his laugh could brighten up your day.</p>

<p>I think, to me, what may have cemented who my brother was, was shown on the day of his funeral. The sheer amount of people from such a wide array of groups who came to pay my brother respect was incredible. In such a short lifetime, my brother was able to touch the lives of so many, something I truly admire him for.</p>

<p>A quote that I came across a few years ago has stuck with me. </p>

<blockquote>
<p>There are moments in each of our lives when something so dramatic happens that one can barely remember what life was like before. These moments reshape the prism through which we can see everything that follows. These moments define the chapters in our lives, and how we react to them defines who we are.</p>
</blockquote>

<p>For me, this moment is when my brother passed away. I feel as if a hard line was drawn through my life on the day of his passing. Coping with my brother&#39;s death has been the single most difficult thing I have had to do. Bad days become worse and no matter how much time passed, it didn&#39;t feel like the pain was going away. Some days, I hate the world for what it has taken from me. It seems like there are days when I can&#39;t remember ever truly being happy.</p>

<p>But, I refuse to let these bad days get the best of me. I refuse to forget the good times I had with my brother and everything he taught me. My whole life, my brother has been my role model, inspiration, and motivation. Until this day, I still want to be like Harel when I grow up. I realize now, if I truly want to be like my brother when I grow up, then I cannot forget what my brother stood for.</p>

<p>So my brother, wherever you may be, I hope you can read this, see this, or hear this and I hope that I&#39;ve made you proud. I hope that one day I can positively influence the lives of as many people you did throughout your lifetime. Hopefully. one day, HK, I&#39;ll be like my big brother.</p>

<p><img src="/images/hk_bk_1.jpg" alt="Harel and Barak"></p>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="notes">
            <p>
                <a href="http://itsbarakyo.com/notes/2014/04/06/play-framework-returning-json-response.html">
                    Play Framework: Returning JSON Responses
                </a>
            </p>
            <small>06 Apr 2014</small>
        </blockquote>
        <p><p>I&#39;ve recently started a project at working using the <a href="http://www.playframework.com/">Play Framework</a> and while its a great framework, I was having a lot of trouble with some of the simplest tasks. I wouldn&#39;t blame Play for my problems, returning to Java after a long hiatus, being spoiled by dynamicly typed languages, and lack of documentation really made such tasks like returning a JSON response difficult.</p>

<p>I figured that I may not be the only in this position, judging by the questions in the IRC channel and lack of responses, I figured it may be a good idea to jot down some of my notes, not only for myself, my coworkers, but for all my fellow Play framework noobs. Apologies for the introduction, I&#39;ll try to keep the rest of this posts and the futures, short, succinct, and to the point.</p>

<h2>tl;dr</h2>

<p>Use ObjectNode class found in the <code>com.fasterxml.jackson.databind.node.ObjectNode</code> package.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.node.ObjectNode</span><span class="o">;</span>

    <span class="n">ObjectNode</span> <span class="n">response</span> <span class="o">=</span> <span class="n">Json</span><span class="o">.</span><span class="na">newObject</span><span class="o">();</span>
    <span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;status&quot;</span><span class="o">,</span> <span class="mi">200</span><span class="o">);</span>
    <span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;message&quot;</span><span class="o">,</span> <span class="s">&quot;Request was successful&quot;</span><span class="o">);</span>
    <span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;data&quot;</span><span class="o">,</span> <span class="n">Json</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">users</span><span class="o">));</span>
    <span class="k">return</span> <span class="nf">ok</span><span class="o">(</span><span class="n">response</span><span class="o">);</span></code></pre></div>

<h2>Using ObjectNode</h2>

<p>To easily return mixed response types, I suggest using the <code>ObjectNode</code> class found in the <code>com.fasterxml.jackson.databind.node.ObjectNode</code> package. Using the class is simple, first instantiate an object:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ObjectNode</span> <span class="n">response</span> <span class="o">=</span> <span class="n">Json</span><span class="o">.</span><span class="na">newObject</span><span class="o">();</span></code></pre></div>
    

<p>From there, you can treat the object similar to a map but using <code>put()</code> function.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;status&quot;</span><span class="o">,</span> <span class="mi">200</span><span class="o">);</span>
    <span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;message&quot;</span><span class="o">,</span> <span class="s">&quot;Request was successful&quot;</span><span class="o">);</span></code></pre></div>

<p>Often times we want to return an object or array of objects. Using the <code>Json.toJson()</code> function found in <code>play.libs.Json</code> we can easily convert objects or lists of objects to be included in our JSON response.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;data&quot;</span><span class="o">,</span> <span class="n">Json</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">users</span><span class="o">));</span></code></pre></div>

<p>Finally, you&#39;ll probably want to use the static return response methods to easily return our JSON response.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="k">return</span> <span class="nf">ok</span><span class="o">(</span><span class="n">response</span><span class="o">);</span></code></pre></div>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="notes">
            <p>
                <a href="http://itsbarakyo.com/notes/2014/04/06/play-framework-parsing-json.html">
                    Play Framework: Parsing Arrays in JSON Requests
                </a>
            </p>
            <small>06 Apr 2014</small>
        </blockquote>
        <p><h2>tl;dr</h2>

<p>I suggest using <code>ObjectMapper</code> found in the <code>com.fasterxml.jackson.databind.ObjectMapper</code></p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ObjectMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">ObjectMapper</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">JsonNode</span> <span class="n">root</span> <span class="o">=</span> <span class="n">request</span><span class="o">().</span><span class="na">body</span><span class="o">().</span><span class="na">asJson</span><span class="o">();</span>
        <span class="n">JsonNode</span> <span class="n">jsonPhoneNumbers</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;phoneNumbers&quot;</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">JsonNode</span> <span class="n">phoneNumberString</span> <span class="o">:</span> <span class="n">jsonPhoneNumbers</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">phoneNumber</span> <span class="o">=</span> <span class="n">phoneNumberString</span><span class="o">.</span><span class="na">asText</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="k">catch</span> <span class="o">(</span><span class="n">NullPointerException</span> <span class="n">npe</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// No valid phone numbers were provided</span>
    <span class="o">}</span></code></pre></div>

<h2>Using ObjectMapper</h2>

<p>For parsing arrays in JSON requests, I suggest using the <code>ObjectMapper</code>. Assuming you have a request that looks like:</p>

<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
        <span class="err">phoneNumbers:</span> <span class="err">[</span>
            <span class="err">&#39;555-555-5555&#39;,</span>
            <span class="err">&#39;555-555-5556&#39;,</span>
            <span class="err">&#39;555-555-5557&#39;</span>
        <span class="err">]</span>
    <span class="p">}</span></code></pre></div>

<p>We can easily access the phone number values by using <code>ObjectMapper</code> class. The first thing that you&#39;d want to do is instantiate an instance of this class, which is pretty straight forward.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ObjectMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">ObjectMapper</span><span class="o">();</span></code></pre></div>

<p>From there, we want a JSON version of our request, the Play framework allows you to easily do so by chaining the <code>asJson()</code> method to the <code>request().body()</code> functions.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">JsonNode</span> <span class="n">root</span> <span class="o">=</span> <span class="n">request</span><span class="o">().</span><span class="na">body</span><span class="o">().</span><span class="na">asJson</span><span class="o">();</span></code></pre></div>

<p>Using the <code>get()</code> function on our <code>root</code> object and providing the correct key, we can easily get our phoneNumbers as a JsonNode, which is also iterable. By iterating through each of the JsonNode objects, we can just return the value for the corresponding phone number as a <code>String</code> by using the <code>asText()</code> method.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">JsonNode</span> <span class="n">jsonPhoneNumbers</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;phoneNumbers&quot;</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="n">JsonNode</span> <span class="n">phoneNumberString</span> <span class="o">:</span> <span class="n">jsonPhoneNumbers</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">phoneNumber</span> <span class="o">=</span> <span class="n">phoneNumberString</span><span class="o">.</span><span class="na">asText</span><span class="o">();</span>
    <span class="o">}</span></code></pre></div>

<p>Since there is a possibility that the request could be empty (null), I suggest wrapping the request processing in a try-catch block. If a request is null or the specified key was not included in the request (in this example it would be <code>phoneNumbers</code>) then we can use the <code>catch</code> portion of the block to easily return a bad request.</p>

<p>Put this all together looks like:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.JsonNode</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.node.ObjectNode</span><span class="o">;</span>
    <span class="kn">import</span> <span class="nn">play.libs.Json</span><span class="o">;</span>

    <span class="n">ObjectMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">ObjectMapper</span><span class="o">();</span>
    <span class="n">ObjectNode</span> <span class="n">response</span> <span class="o">=</span> <span class="n">Json</span><span class="o">.</span><span class="na">newObject</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">JsonNode</span> <span class="n">root</span> <span class="o">=</span> <span class="n">request</span><span class="o">().</span><span class="na">body</span><span class="o">().</span><span class="na">asJson</span><span class="o">();</span>
        <span class="n">JsonNode</span> <span class="n">jsonPhoneNumbers</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;phoneNumbers&quot;</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">JsonNode</span> <span class="n">phoneNumberString</span> <span class="o">:</span> <span class="n">jsonPhoneNumbers</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">phoneNumber</span> <span class="o">=</span> <span class="n">phoneNumberString</span><span class="o">.</span><span class="na">asText</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="k">catch</span> <span class="o">(</span><span class="n">NullPointerException</span> <span class="n">npe</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// No valid phone numbers were provided</span>
        <span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;status&quot;</span><span class="o">,</span> <span class="mi">400</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;message&quot;</span><span class="o">,</span> <span class="s">&quot;No phone numbers were provided&quot;</span><span class="o">);</span>
        <span class="k">return</span> <span class="nf">badRequest</span><span class="o">(</span><span class="n">response</span><span class="o">);</span>
    <span class="o">}</span></code></pre></div>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="projects">
            <p>
                <a href="http://itsbarakyo.com/projects/2013/12/08/counter-resets-and-database-magic.html">
                    Counter Resets and Database Magic
                </a>
            </p>
            <small>08 Dec 2013</small>
        </blockquote>
        <p><p>Recently, the need for a standard numbering convention came up for one of our projects at work. The client 
requested to be able to access protocols by a unique ID. Originally I thought it&#39;d be a no brainer, I&#39;d explain 
to them that the each protocol is already uniquely identifiable within the database, and they can just refer to 
protocols by their unique ID in the database. Unfortunately, they didn&#39;t seem too fond of the unique ID numbering 
scheme and proposed that the application follow a certain convention, which they created.</p>

<p>The convention was simple enough to understand. It followed the format of:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">YYYY-XXX
</code></pre></div>
<p>Where <code>YYYY</code> was the Academic Year and <code>XXX</code> was a 3 digit number signifying that it was the nth protocol 
scheduled for review of that academic year. For example, a protocol with the number</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">1314-016
</code></pre></div>
<p>Would be the 16th protocol scheduled within the 2013-2014 academic year.</p>

<p>While the standard is easy enough, it brings up some concerns.</p>

<ol>
<li>Protocol numbers are generated once a protocol has been scheduled for committee review.</li>
<li>Protocol numbers must refer to a specific protocol.</li>
<li>The protocol number must reset after every academic year.</li>
<li>How can I enforce this standard within the database?</li>
</ol>

<p>Regarding the first concern, I couldn&#39;t simply append a column to the protocol table since I would have a <code>NULL</code> 
field until the protocol was scheduled (if it was ever scheduled). While adding a column would allow me to specify
which number belonged to which protocol, it invalidate the 3NF standard I&#39;m trying to achieve. Also, how 
would I have the database automatically increment or reset the value of the counter?</p>

<p>I realized quickly that I needed another table (or two). Immediately, I realized that my <code>protocol_number</code> 
table would need the following columns:</p>

<ul>
<li>ID - mainly for reference</li>
<li>Protocol ID - specifies which number this protocol refers to</li>
<li>Academic Year - the year part of the number convention</li>
<li>Protocol Number - the counter part of the number convention</li>
</ul>

<p>While designing the table, I also realized that I didn&#39;t want to have to worry about the application needing to 
worry about which protocol number to insert within the column and that lead me to the idea of a trigger. I know 
that I can easily count the number of rows within a table using the SQL command <code>count(*)</code>, but how could I use 
it for handling the protocol number field? I realized that my answer would rely in a trigger that would fire 
before each insert on the table.</p>

<p>Before jumping into creating the trigger, I had to give some more thought to the the academic year field. While 
I could easily represent academic years with an <code>INT</code> field, it didn&#39;t seem to be sufficient, something just felt 
dirty. I made the decision that I&#39;d create a new table, <code>academic_year</code>, which would simply store academic years. 
This way, I could have the <code>protocol_number</code> table refer to the <code>academic_year</code> table as a foreign key.
Specifying the field as a foreign key also provided me the added benefit of being able to lookup which protocols
were scheduled for what year (a feature that hasn&#39;t been asked for, but can now be easily implemented).</p>

<p>Given this analysis, we&#39;ve composed two tables with the following structure:</p>

<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nf">academic_year</span><span class="p">(</span>
    <span class="n">id</span> <span class="kt">int</span> <span class="k">UNSIGNED</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="kp">AUTO_INCREMENT</span><span class="p">,</span>
    <span class="n">academic_year</span> <span class="kt">int</span> <span class="k">UNSIGNED</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nf">protocol_number</span><span class="p">(</span>
    <span class="n">id</span> <span class="kt">int</span> <span class="k">UNSIGNED</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="kp">AUTO_INCREMENT</span><span class="p">,</span>
    <span class="n">academic_year_id</span> <span class="kt">int</span> <span class="k">UNSIGNED</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="n">protocol_id</span> <span class="kt">int</span> <span class="k">UNSIGNED</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="n">protocol_number</span> <span class="kt">int</span> <span class="k">UNSIGNED</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">protocol_id</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="nf">protocols</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
    <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span></code></pre></div>

<p>Almost complete. We still have one tiny little problem. We want to ensure that our protocol numbers are unique 
and also that they&#39;re unique to a single protocol. Using primary keys we can specify that our <code>protocol_number</code> 
and <code>academic_year_id</code> columns are unique. In addition, we can easily add a unique key on our <code>protocol_id</code> field 
allowing us to ensure that this field is also unique. Doing so creates the following structure:</p>

<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nf">protocol_number</span><span class="p">(</span>
    <span class="n">id</span> <span class="kt">int</span> <span class="k">UNSIGNED</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="kp">AUTO_INCREMENT</span><span class="p">,</span>
    <span class="n">academic_year_id</span> <span class="kt">int</span> <span class="k">UNSIGNED</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="n">protocol_id</span> <span class="kt">int</span> <span class="k">UNSIGNED</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="n">protocol_number</span> <span class="kt">int</span> <span class="k">UNSIGNED</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">protocol_id</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="nf">protocols</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
    <span class="k">UNIQUE</span> <span class="k">KEY</span> <span class="nf">unique_protocol_id</span> <span class="p">(</span><span class="n">protocol_id</span><span class="p">),</span>
    <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">academic_year_id</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="nf">academic_year</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
    <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">protocol_number</span><span class="p">,</span> <span class="n">academic_year_id</span><span class="p">),</span>
    <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span></code></pre></div>

<p>Finally, we can create our trigger to handle incrementing the counter. Our trigger will be based around the query</p>

<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">SELECT</span> <span class="nf">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">num_protocols</span> 
<span class="k">FROM</span> <span class="n">eirb_number</span> 
<span class="k">WHERE</span> <span class="n">academic_year_id</span><span class="o">=</span><span class="p">[</span><span class="n">ACADEMIC_YEAR_ID</span><span class="p">]</span></code></pre></div>

<p>The query will return the number of rows that exist with the given <code>ACADEMIC_YEAR_ID</code>. All we would have to do 
now is take the results of this query, increment it by 1, and then set it as the value for the 
<code>protocol_number</code> column for the new row being inserted into the database. Given our analysis it sounds like 
we have all we need to create our a trigger, that is, when it occurs, <code>BEFORE INSERT</code> and  what we want to 
add/change <code>protocol_number</code> with our <code>count(*)</code> value.</p>

<p>Behold, our trigger:</p>

<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="n">delimiter</span> <span class="o">//</span>
<span class="k">CREATE</span> <span class="k">TRIGGER</span> <span class="n">insert_protocol_num_trigger</span> 
<span class="k">BEFORE</span> <span class="k">INSERT</span> <span class="k">on</span> <span class="n">eirb_number</span>
<span class="k">for</span> <span class="k">each</span> <span class="n">row</span>
<span class="n">BEGIN</span>
    <span class="kt">SET</span> <span class="n">new</span><span class="p">.</span><span class="n">protocol_number</span> <span class="o">=</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="nf">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">num_protocols</span> 
        <span class="k">FROM</span> <span class="n">eirb_number</span> 
        <span class="k">WHERE</span> <span class="n">academic_year_id</span><span class="o">=</span><span class="n">new</span><span class="p">.</span><span class="n">academic_year_id</span>
    <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">END</span><span class="p">;</span> <span class="o">//</span>
<span class="n">DELIMITER</span> <span class="p">;</span></code></pre></div>

<p>Now all our queries/application have to worry about is what protocol they want to create the number for and 
which academic year that protocol belongs to. The database will handle the rest. Our insert query can now look 
something like:</p>

<div class="highlight"><pre><code class="language-mysql" data-lang="mysql"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="nf">protocol_number</span><span class="p">(</span><span class="n">protocol_id</span><span class="p">,</span> <span class="n">academic_year_id</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span></code></pre></div>

<p>Now we&#39;ve handled the case of reset counters through the use of database magic (AKA triggers).</p>

<!---
 Protocols can also have renewals and 
revisions, which would follow a similar format, just with certain extensions. If the protocol from the previous 
example was renewed for another year, then the renewed protocol would have the number:

    1314-016-a

The appended letters `a-z` would sig
-->
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="notes">
            <p>
                <a href="http://itsbarakyo.com/notes/2013/11/24/more-tdd-and-recursion-practice.html">
                    More TDD and Recursion Practice
                </a>
            </p>
            <small>24 Nov 2013</small>
        </blockquote>
        <p><p>It seems that Javascript challenges are more frequent at work. Thursday afternoon when we got back from lunch, my coworker was testing himself in the <a href="http://toys.usvsth3m.com/javascript-under-pressure/">You Can&#39;t Javascript Under Pressure</a> challenges. As great coworkers, we (by that I mean, me) decided to help out and put more pressure on our fellow coworker, without even being asked to! One of the challenges that came up during the test was a function <code>ArraySum()</code> which accepts a list (array) of values and you must total all the integers within the array. The array could contain strings, numbers, booleans, lists of strings, numbers, booleans, etc. Regardless of the input, you must total all the integers within the array. After seeing that challenge (and helping with the correct answer), I thought it might be good practice for another blog post.</p>

<h3>Practice makes Perfect</h3>

<p>Before jumping into more testing and programming, I want to stop and think about my methodology. While re-reading <a href="http://chimera.labs.oreilly.com/books/1234000000754/ch03.html">Chapter 3</a> of <a href="http://chimera.labs.oreilly.com/books/1234000000754/index.html">Test-Driven Web Development with Python</a> on Friday with a coworker, I realized that almost every line of code that was written in the chapter to satisfy the test, had a test case as a reason to write that code. After seeing this and thinking about my previous blog post, I realized I didn&#39;t follow the TDD methodology as closely as I <del>could</del>should have. According to the author, Harry Percival, TDD is a discipline, it even says so in chapter 4.</p>

<blockquote>
<p>TDD is a discipline, and that means it&#39;s not something that comes naturally; because many of the payoffs aren&#39;t immediate but only come in the longer term, you have to force yourself to do it in the moment.</p>
</blockquote>

<p>To cut myself some slack, TDD is something you have to practice. Yes, I&#39;m talking about <a href="http://www.youtube.com/watch?v=eGDBR2L5kzI">practice</a>. I&#39;m sure there are a bunch of young grasshoper learning quotes I could state right now, but lets get on to testing.</p>

<h3>Stricter Test Cases</h3>

<p>Last time we started by importing our function and writing a basic test case to test the return type. Let&#39;s do that again.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">arraysum</span> <span class="kn">import</span> <span class="n">ArraySum</span>

<span class="k">class</span> <span class="nc">ArraySumTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">test_for_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">ArraySum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">,</span> <span class="s">&quot;Result is not integer&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span></code></pre></div>

<p>Looks good to me, lets run it!</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<span class="n">File</span> <span class="s">&quot;tests.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
  <span class="kn">from</span> <span class="nn">arraysum</span> <span class="kn">import</span> <span class="n">ArraySum</span>
  <span class="ne">ImportError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="n">arraysum</span></code></pre></div>

<p>Our first error! Lets correct it, but remember, minimal amount of code! In fact, we won&#39;t right any code at all.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">caster:arraysum/ <span class="nv">$ </span>touch arraysum.py</code></pre></div>
 

<p>Let&#39;s re-run our test.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<span class="n">File</span> <span class="s">&quot;tests.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
  <span class="kn">from</span> <span class="nn">arraysum</span> <span class="kn">import</span> <span class="n">ArraySum</span>
  <span class="ne">ImportError</span><span class="p">:</span> <span class="n">cannot</span> <span class="kn">import</span> <span class="nn">name</span> <span class="nn">ArraySum</span></code></pre></div>

<p>Yay new error! This time it can&#39;t find our function, <code>ArraySum</code>, lets (minimally) create that in our new <code>arraysum.py</code> file.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">ArraySum</span><span class="p">(</span><span class="n">int_list</span><span class="p">):</span>
    <span class="k">pass</span></code></pre></div>

<p>Okay, let&#39;s see what we get now.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">F</span>
<span class="o">======================================================================</span>
<span class="n">FAIL</span><span class="p">:</span> <span class="n">test_for_int</span> <span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">ArraySumTests</span><span class="p">)</span>
<span class="o">----------------------------------------------------------------------</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">&quot;tests.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">10</span><span class="p">,</span> <span class="ow">in</span> <span class="n">test_for_int</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">,</span> <span class="s">&quot;Result is not integer&quot;</span><span class="p">)</span>
  <span class="ne">AssertionError</span><span class="p">:</span> <span class="n">Result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">integer</span>

<span class="o">----------------------------------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">1</span> <span class="n">test</span> <span class="ow">in</span> <span class="mf">0.000</span><span class="n">s</span>

<span class="n">FAILED</span> <span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code></pre></div>

<p><del>More</del>MOAR errors!! This time our test is failing because we&#39;re not returning an integer. Let&#39;s fix that by modifying our return statement.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">ArraySum</span><span class="p">(</span><span class="n">int_list</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">0</span></code></pre></div>

<p>Alright, lets re-run our test.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">.</span>
<span class="o">----------------------------------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">1</span> <span class="n">test</span> <span class="ow">in</span> <span class="mf">0.000</span><span class="n">s</span>

<span class="n">OK</span></code></pre></div>

<p>Woohoo! Our first test passed. According to TDD, we can now write some more tests. Let&#39;s make this one a little more interesting.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">arraysum</span> <span class="kn">import</span> <span class="n">ArraySum</span>

<span class="k">class</span> <span class="nc">ArraySumTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">test_for_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">ArraySum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">,</span> <span class="s">&quot;Result is not integer&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_flat_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">ArraySum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">15</span><span class="p">,</span> <span class="s">&quot;Incorrect sum&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span></code></pre></div>

<p>We&#39;ve now added a new test, <code>test_flat_list</code> to test a simple list of integers and ensure the sum is correct. Back to running tests...</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">F</span><span class="o">.</span>
<span class="o">======================================================================</span>
<span class="n">FAIL</span><span class="p">:</span> <span class="n">test_flat_list</span> <span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">ArraySumTests</span><span class="p">)</span>
<span class="o">----------------------------------------------------------------------</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<span class="n">File</span> <span class="s">&quot;tests.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">14</span><span class="p">,</span> <span class="ow">in</span> <span class="n">test_flat_list</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">15</span><span class="p">,</span> <span class="s">&quot;Incorrect sum&quot;</span><span class="p">)</span>
  <span class="ne">AssertionError</span><span class="p">:</span> <span class="n">Incorrect</span> <span class="nb">sum</span>

<span class="o">----------------------------------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">2</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.000</span><span class="n">s</span>

<span class="n">FAILED</span> <span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code></pre></div>

<p>The obvious problem here is that our function is returning 0 and not doing any sort of summation. According to TDD, we want to write the minimal amount of code, Python, being the beautiful language that it is, provides us with a simple <code>sum</code> function which operates on iterables. Allowing us to very easily pass our <code>test_with_flat_list</code> test.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">ArraySum</span><span class="p">(</span><span class="n">int_list</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">int_list</span><span class="p">)</span></code></pre></div>

<p>Running our test again will show that we were able to successfully pass it.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">..</span>
<span class="o">----------------------------------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">2</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.000</span><span class="n">s</span>

<span class="n">OK</span></code></pre></div>

<p>We can continue writing more test cases, so lets make it a little more interesting. We&#39;ll introduce some non-integer values into the list, which will create errors for our <code>sum</code> function in a test case called <code>test_complex_list</code>.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">arraysum</span> <span class="kn">import</span> <span class="n">ArraySum</span>

<span class="k">class</span> <span class="nc">ArraySumTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">test_for_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">ArraySum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">,</span> <span class="s">&quot;Result is not integer&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_flat_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">ArraySum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">15</span><span class="p">,</span> <span class="s">&quot;Incorrect sum&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">test_complex_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">ArraySum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&quot;Incorrect sum&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span></code></pre></div>

<p>Running our tests, returns the results:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">E</span><span class="o">..</span>
<span class="o">======================================================================</span>
<span class="n">ERROR</span><span class="p">:</span> <span class="n">test_complex_list</span> <span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">ArraySumTests</span><span class="p">)</span>
<span class="o">----------------------------------------------------------------------</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">&quot;tests.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">17</span><span class="p">,</span> <span class="ow">in</span> <span class="n">test_complex_list</span>
  <span class="n">result</span> <span class="o">=</span> <span class="n">ArraySum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">])</span>
    <span class="n">File</span> <span class="s">&quot;/home/caster/Development/arraysum/arraysum.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ArraySum</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">int_list</span><span class="p">)</span>
        <span class="ne">TypeError</span><span class="p">:</span> <span class="n">unsupported</span> <span class="n">operand</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="o">+</span><span class="p">:</span> <span class="s">&#39;int&#39;</span> <span class="ow">and</span> <span class="s">&#39;str&#39;</span>

<span class="o">----------------------------------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">3</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.000</span><span class="n">s</span>

<span class="n">FAILED</span> <span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code></pre></div>

<p>Just as we expected! Let&#39;s make some corrections to our <code>ArraySum</code> function.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">ArraySum</span><span class="p">(</span><span class="n">int_list</span><span class="p">):</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">int_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="nb">sum</span></code></pre></div>

<p>After making our fix, we&#39;ll re-run our test and...</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">...</span>
<span class="o">----------------------------------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">3</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.000</span><span class="n">s</span>

<span class="n">OK</span></code></pre></div>

<p>Looks good! Once again, passed test cases means we can write more tests, so lets give it a go one last time. We&#39;ll create a new test case, <code>test_complex_nested_list</code>, where we&#39;ll introduce a nested list into our previous complex list. A nested list within our function also brings in the sense of recursion! We&#39;ll want to take in account what we have, where we want to go, and if we&#39;ve done something like this before (which we have). Currently we&#39;re iterating through all the values and if they&#39;re integers we&#39;ll add them to our <code>sum</code> variable. We&#39;re throwing away that is anything but an <code>int</code>. We know this is wrong though since the function must also include the values within nested lists, hence the embarrassingly recursive algorithm.</p>

<p>We know that we&#39;re going to have to iterate through the values in our list, so we understand that, but lets look at our cases:</p>

<ul>
<li>Value is an <code>int</code>: Add to sum</li>
<li>Value is a <code>list</code>: Add the total of the list to sum</li>
<li>Value is neither: Ignore</li>
</ul>

<p>Now that we have an idea of what we want to do, lets write our last test case.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">arraysum</span> <span class="kn">import</span> <span class="n">ArraySum</span>

<span class="k">class</span> <span class="nc">ArraySumTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">test_for_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">ArraySum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">,</span> <span class="s">&quot;Result is not integer&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_flat_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">ArraySum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">15</span><span class="p">,</span> <span class="s">&quot;Incorrect sum&quot;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">test_complex_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">ArraySum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&quot;Incorrect sum&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_complex_nested_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">ArraySum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">15</span><span class="p">,</span> <span class="s">&quot;Incorrect sum&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span></code></pre></div>

<p>Before we make any changes to <code>ArraySum</code>, we have to run our test.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">.</span><span class="n">F</span><span class="o">..</span>
<span class="o">======================================================================</span>
<span class="n">FAIL</span><span class="p">:</span> <span class="n">test_complex_nested_list</span> <span class="p">(</span><span class="n">__main__</span><span class="o">.</span><span class="n">ArraySumTests</span><span class="p">)</span>
<span class="o">----------------------------------------------------------------------</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">&quot;tests.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">22</span><span class="p">,</span> <span class="ow">in</span> <span class="n">test_complex_nested_list</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">15</span><span class="p">,</span> <span class="s">&quot;Incorrect sum&quot;</span><span class="p">)</span>
      <span class="ne">AssertionError</span><span class="p">:</span> <span class="n">Incorrect</span> <span class="nb">sum</span>

<span class="o">----------------------------------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">4</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.000</span><span class="n">s</span>

<span class="n">FAILED</span> <span class="p">(</span><span class="n">failures</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code></pre></div>

<p>Now that we have a failed test, we are given the okay by the testing goat to modify our code. Let&#39;s add our recursive call, so our function now looks like:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">ArraySum</span><span class="p">(</span><span class="n">int_list</span><span class="p">):</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">int_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">x</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">ArraySum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span></code></pre></div>

<p>Re-running our final test...</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">....</span>
<span class="o">----------------------------------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">4</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.000</span><span class="n">s</span>

<span class="n">OK</span></code></pre></div>

<p>Ahhhhh :)</p>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="notes">
            <p>
                <a href="http://itsbarakyo.com/notes/2013/11/17/flatten_dictionary_challenge.html">
                    Code Challenge: Dictionary Flatten
                </a>
            </p>
            <small>17 Nov 2013</small>
        </blockquote>
        <p><p>While browsing <a href="http://www.reddit.com/r/javascript">/r/javascript</a> Thursday night, I came across a post regrading a <a href="http://www.reddit.com/r/javascript/comments/1qn7bo/mildly_interesting_question_i_got_while/">mildly interesting interview question</a> which had to do with flattening a Javascript object to a URI.</p>

<p>Two things immediately jumped into my mind:</p>

<ol>
<li>I have to show one of my coworkers.</li>
<li>This would make a &quot;midly interesting&quot; Python challenge!</li>
</ol>

<p>Friday morning, the first thing I did when I got into work was write the challenge on our white board and my solution in Python. Funny enough, once I came back from lunch, my coworker was writing his Javascript solution next to my Python one. It turns out that he saw the challenge Thursday night and even posted his solution to the thread.</p>

<p>I figured, I&#39;d code up my solution and give it a shot. Both for recursive practice and writing test cases. So to start with some test driven development (TDD), I began by writing a simple test case.</p>

<p>First we&#39;ll define a class for our test cases:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">unittest</span>
<span class="k">class</span> <span class="nc">FlattenTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span></code></pre></div>

<p>From there, we&#39;ll add a simple <code>setUp</code> method which creates a dictionary to use for testing:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">unittest</span>

<span class="k">class</span> <span class="nc">FlattenTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">example</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&quot;foo&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">&quot;bar&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s">&quot;team&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                        <span class="s">&quot;company&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;Bill&quot;</span><span class="p">,</span> <span class="s">&quot;Ted&quot;</span><span class="p">]</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span></code></pre></div>

<p>Now lets define a test case!</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">unittest</span>

<span class="k">class</span> <span class="nc">FlattenTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">example</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&quot;foo&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">&quot;bar&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s">&quot;team&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                        <span class="s">&quot;company&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;Bill&quot;</span><span class="p">,</span> <span class="s">&quot;Ted&quot;</span><span class="p">]</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>

    <span class="k">def</span> <span class="nf">test_for_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">example</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span></code></pre></div>

<p>The test case we&#39;ve defined, <code>test_for_dict</code>, just determines if the return type of the <code>flatten</code> method (which we haven&#39;t written yet) is of type dictionary. Lets run our test case and see what we get!</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">ERROR: test_for_dict <span class="o">(</span>__main__.FlattenTests<span class="o">)</span>
----------------------------------------------------------------------
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
File <span class="s2">&quot;tests.py&quot;</span>, line 16, in test_for_dict
<span class="nv">d</span> <span class="o">=</span> flatten<span class="o">(</span>self.example, <span class="s2">&quot;&quot;</span><span class="o">)</span>
NameError: global name <span class="s1">&#39;flatten&#39;</span> is not defined
----------------------------------------------------------------------</code></pre></div>

<p>Ahh what was that!? According to my understanding of TDD, this is a good thing! We can start writing code now. Lets define a new file <code>flatten.py</code> and create a flatten function that accepts a dictionary and string. Remember, according to TDD, we must right the most minimal amount of code that will pass our test.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">d_flat</span><span class="p">,</span> <span class="n">key_string</span><span class="p">):</span>
    <span class="k">pass</span></code></pre></div>

<p>Well that was simple enough, lets run our test.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">======================================================================</span>
FAIL: test_for_dict <span class="o">(</span>__main__.FlattenTests<span class="o">)</span>
----------------------------------------------------------------------
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
File <span class="s2">&quot;tests.py&quot;</span>, line 17, in test_for_dict
self.assertTrue<span class="o">(</span><span class="nb">type</span><span class="o">(</span>d<span class="o">)</span> is dict<span class="o">)</span>
AssertionError: False is not <span class="nb">true</span>
----------------------------------------------------------------------</code></pre></div>

<p>Hmm, seems like we didn&#39;t write enough code! Lets go back and update our <code>flatten</code> function.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">d_flat</span><span class="p">,</span> <span class="n">key_string</span><span class="p">):</span>
   <span class="k">return</span> <span class="p">{}</span></code></pre></div>

<p>Now that we&#39;ve updated our code, lets run our test again.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">caster:flatten/ <span class="nv">$ </span>python tests.py
.
----------------------------------------------------------------------
Ran <span class="m">1</span> <span class="nb">test </span>in 0.000s

OK</code></pre></div>

<p>Looks good to me! Now that one of our tests has passed, we can now write another (more interesting) test! I&#39;m not very creative at writing these incremental tests, so lets just get to it.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">flatten</span> <span class="kn">import</span> <span class="n">flatten</span>

<span class="k">class</span> <span class="nc">FlattenTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">example</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&quot;foo&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">&quot;bar&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s">&quot;team&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                        <span class="s">&quot;company&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;Bill&quot;</span><span class="p">,</span> <span class="s">&quot;Ted&quot;</span><span class="p">]</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>

    <span class="k">def</span> <span class="nf">test_for_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">example</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_case_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">example</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&quot;foo/bar/team&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&quot;foo/bar/company&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s">&quot;Bill&quot;</span><span class="p">,</span> <span class="s">&quot;Ted&quot;</span><span class="p">])</span> 

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">unittest</span></code></pre></div>

<p>We&#39;ve defined a new test case, <code>test_case_one</code>, (like I said, I&#39;m not very creative), that&#39;ll run our <code>flatten</code> function and determine if we&#39;ve received the correct output. Lets try running our test case now (and cross our fingers) to see if it fails.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">caster:flatten/ <span class="nv">$ </span>python tests.py
E.
<span class="o">======================================================================</span>
ERROR: test_case_one <span class="o">(</span>__main__.FlattenTests<span class="o">)</span>
----------------------------------------------------------------------
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
File <span class="s2">&quot;tests.py&quot;</span>, line 21, in test_case_one
self.assertTrue<span class="o">(</span>d<span class="o">[</span><span class="s2">&quot;foo/bar/team&quot;</span><span class="o">])</span>
KeyError: <span class="s1">&#39;foo/bar/team&#39;</span>

----------------------------------------------------------------------
Ran <span class="m">2</span> tests in 0.000s

FAILED <span class="o">(</span><span class="nv">errors</span><span class="o">=</span>1<span class="o">)</span></code></pre></div>

<p>Awesome! More good news! :) Before we jump into writing our function, lets think about what we want the function to do.</p>

<ul>
<li>First we&#39;ll need to iterate through all the key/value pairs in the dictionary passed to the function.</li>
<li>We&#39;ll then need to determine if the value for the key we&#39;ve iterated to is a dictionary or not.

<ul>
<li>If the value is a dictionary, we&#39;ll want to recursively call <code>flatten</code> and append our key to <code>key_string</code> so that we&#39;re keeping track of the key we want to eventually use.</li>
</ul></li>
<li>The easy (or base) case, if our value is <strong>NOT</strong> a dictionary, simply add it to the dictionary with it&#39;s key append to <code>key_string</code></li>
<li>Finally, once we&#39;ve iterated through all the values, return the dictionary.</li>
</ul>

<p>When we put it like that, it sounds easy! (Or so I hope...)</p>

<p>Lets take care of iterating through the dictionary, that sounds easy enough:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">d_flat</span><span class="p">,</span> <span class="n">key_string</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">d_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">d</span></code></pre></div>

<p>Simple enough, we&#39;ve declared an empty dictionary <code>d</code> and started iterating through the items in the dictionary. Lets take a look at our first case, if the value for a key is a dictionary:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">d_flat</span><span class="p">,</span> <span class="n">key_string</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">d_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">d</span></code></pre></div>

<p>Okay we&#39;ve added our if statement, now if it&#39;s true, we&#39;ll have to recursively call our function. Before we jump to make the recursive call, we need to ensure we&#39;re keeping track of our <code>key_string</code> value. To do so, we&#39;ll pass <code>key_string</code> with the current key value, <code>k</code>. We&#39;ll recursively call <code>flatten</code> with the inner dictionary stored in <code>v</code>.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">d_flat</span><span class="p">,</span> <span class="n">key_string</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">d_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">key_string</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">d</span></code></pre></div>

<p>Almost there! We now need to worry about our base case, so let&#39;s take care of that! Recall that we said if our value is not of type dictionary, we simple append it to our dictionary that we declared, <code>d</code>. Again, we have to keep in mind that we want to assign the correct key for our value, which would be our current <code>key_string</code> concatenated with the current key we&#39;re looking at, <code>k</code>. Once we create the right key, we&#39;ll just assign it to our value, <code>v</code> and return our dictionary, <code>d</code>.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">d_flat</span><span class="p">,</span> <span class="n">key_string</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">d_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">key_string</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">key_string</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="k">return</span> <span class="n">d</span></code></pre></div>

<p>So good so far, lets run our tests!</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">caster:flatten/ <span class="nv">$ </span>python tests.py
..
----------------------------------------------------------------------
Ran <span class="m">2</span> tests in 0.000s

OK</code></pre></div>

<p>Perfect...or so we think. There&#39;s actually a problem in our algorithm, which we can expose by making our testing data little more robust. Lets update our <code>setUp</code> and our <code>test_case_one</code> functions so they look like this:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">flatten</span> <span class="kn">import</span> <span class="n">flatten</span>

<span class="k">class</span> <span class="nc">FlattenTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">example</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&quot;foo&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">&quot;bar&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s">&quot;team&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                        <span class="s">&quot;company&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;Bill&quot;</span><span class="p">,</span> <span class="s">&quot;Ted&quot;</span><span class="p">]</span>
                        <span class="p">}</span>
                    <span class="p">},</span>
                    <span class="s">&quot;fizz&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s">&quot;blue&quot;</span><span class="p">:</span> <span class="s">&quot;red&quot;</span>
                    <span class="p">}</span>
                <span class="p">}</span>

    <span class="k">def</span> <span class="nf">test_for_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">example</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_case_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">example</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&quot;foo/bar/team&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&quot;foo/bar/company&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s">&quot;Bill&quot;</span><span class="p">,</span> <span class="s">&quot;Ted&quot;</span><span class="p">])</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&quot;foo/bar/fiz/blue&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="s">&quot;red&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span></code></pre></div>

<p>We&#39;ve added another key that points to another dictionary. Nothing unusual or out of the oridinary. We&#39;ve also added a new assertion to ensure that the key <code>foo/bar/fiz/blue</code> contains the string <code>red</code>. Lets run our test case and see what happens.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">caster:flatten/ <span class="nv">$ </span>python tests.py
E.
<span class="o">======================================================================</span>
ERROR: test_case_one <span class="o">(</span>__main__.FlattenTests<span class="o">)</span>
----------------------------------------------------------------------
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
File <span class="s2">&quot;tests.py&quot;</span>, line 21, in test_case_one
self.assertTrue<span class="o">(</span>d<span class="o">[</span><span class="s2">&quot;foo/bar/team&quot;</span><span class="o">])</span>
KeyError: <span class="s1">&#39;foo/bar/team&#39;</span>

----------------------------------------------------------------------
Ran <span class="m">2</span> tests in 0.000s

FAILED <span class="o">(</span><span class="nv">errors</span><span class="o">=</span>1<span class="o">)</span></code></pre></div>

<p>Failed! What&#39;s going on here? If you take a look at our algorithm, we&#39;re not <strong>updating</strong> our dictionary when we return from a recursive call, we&#39;re actually <strong>overwriting</strong> it. Let&#39;s make a small change and ensure we&#39;re updating our dictionary and see what happens.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">d_flat</span><span class="p">,</span> <span class="n">key_string</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">d_flat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">key_string</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">key_string</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="k">return</span> <span class="n">d</span></code></pre></div>

<p>Now lets run our tests.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">caster:flatten/ <span class="nv">$ </span>python tests.py
..
----------------------------------------------------------------------
Ran <span class="m">2</span> tests in 0.000s

OK</code></pre></div>

<p>All is well and now our function works as expected!</p>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="personal">
            <p>
                <a href="http://itsbarakyo.com/personal/2013/11/12/why-barakyo.html">
                    Why Barakyo?
                </a>
            </p>
            <small>12 Nov 2013</small>
        </blockquote>
        <p><p>Over this past weekend I was asked, twice, &quot;Why Barakyo?&quot; While the explanation is simple enough, I sometimes get the response that my Barakyo nickname isn&#39;t professional. I&#39;ve even been told I should consider choosing another domain name. While I understand that my nickname isn&#39;t professional and even though I share my blog with companies that I am interested in, I didn&#39;t want to strip my blog of me, hence the reason for the personal category. One of my goals for my blog was that it would still express me, without having to be techincal. One way of doing that is through the use of my domain name, to me it&#39;s fun, expressive, and short! It&#39;s also pretty easy to spell over the phone :)</p>

<p><strong>Legality</strong></p>

<p>One tangent before I do jump into my nickname. There is some slight confusion on the spelling of my actual name (Barak or Barack). Legally, my name is spelled <strong>Barack</strong>. According to my parents, somewhere in my childhood, I, myself, decided that the correct spelling for my name was <strong>Barak</strong>. I don&#39;t personally remember when I made the switch, but from what I can remember I&#39;ve been spelling my name Barak my whole life. Eventually, I&#39;ll get around to changing my name legally so I have a uniform spelling.</p>

<p><strong>History: AOL Instant Messanger</strong></p>

<p>It seems like now is a better time than ever to actually introduce the history of my nickname, Barakyo. When my friends and I were in middle school and high school, AOL Instant Messanger (AIM) was the hip messenger to be on, EVERYONE was on it. Cool nicknames and aliases were rampant, but my friends and I had a different idea in mind. Young rebels at heart, we went against the grain, we decided to actually INCLUDE our names in our AIM screen names. Originally our screen names started out as, <code>quack its robert</code> and <code>woof its barak</code>. But this level of rebelling wasn&#39;t enough for us, we need <del>more</del><strong>MOAR</strong>.</p>

<p>Somewhere between 2003 and 2004, I was having a discussion over AIM with my friend <a href="http://ryantdesign.com/">Ryan</a>. We had the incredibly clever idea of making screen names that literally told people who we were. This dawned my previous screen name and Ryan&#39;s current screen name, <code>its me barak</code> and <code>itsa me uh ryan</code>. Again, I was not satisfied, something was missing from my screen name. Finally, a few days later, it hit me, <code>its barak yo</code> would be my screen name, who wouldn&#39;t like that?!</p>

<p><strong>Birth of Barakyo</strong></p>

<p>With the creation of my screen name, Barakyo was born! It wasn&#39;t until later on in high school that my nickname really started catching on. It seemed my screen name grew popular amongst my friends as whenever they would see me, they&#39;d always say something along the lines of, &quot;Hey! It&#39;s Barak, yo.&quot; Somehow through the recitement of my screen name, the comma was dropped and my name just became, Barakyo. </p>

<p>In addition to my popular screen name, my away messages, which were stolen from popular rap songs, seem to also aid my nickname.  Some of my more catchy away messages included:</p>

<blockquote>
<p>It&#39;s Barakyo commin&#39; out yo stereo</p>
</blockquote>

<p>and</p>

<blockquote>
<p>But I ain&#39;t 5-0, yall know its Barakyo!</p>
</blockquote>

<p><strong>Barakyo today</strong></p>

<p>Present day Barakyo is a simpler man. One who does not refer to himself in the third person :P I often still get phone calls where the minute I answer the phone the person on the other line will yell, &quot;Barakyo comin&#39; out my stereo!&quot; I love these phone calls, they put a smile on my face the second I hear them. In addition, I still use my nickname Barakyo whenever something calls for a more personalized touch, hence my blog :)</p>

<p>Now you know all there is to know about Barakyo...</p>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="notes">
            <p>
                <a href="http://itsbarakyo.com/notes/2013/11/10/writing-test-cases-for-laravel.html">
                    Writing Test Cases for Laravel
                </a>
            </p>
            <small>10 Nov 2013</small>
        </blockquote>
        <p><p>Besides writing test cases just because &quot;everyone else is&quot;, we should be writing test cases since they&#39;ll help create a stronger trust in our code that our functions are doing what they should be doing.</p>

<h3>Requirements</h3>

<ul>
<li>PHP</li>
<li>PHPUnit (you will most likely need a global install) </li>
<li>Test Cases (DUH)</li>
</ul>

<h3>Helpers</h3>

<p>Helpers are a set of classes that we create to take care of common mundane tasks. For example, the User Helper for testing provides functions for returning a user with a specified role or easily create a new user with the specified role if one does not exist or the user requests one.</p>

<p>Since we can define helpers for a number of things, we want to ensure that the helpers for our test case don&#39;t conflict with helpers that we use in other applications, for this we&#39;ll create our test helpers in the sub-namespace <code>Testing</code> within the <code>Helpers</code> name space.</p>

<p>PHP Namespaces are defined as the first line after the <code>&lt;?php</code> opening. It <strong>MUST</strong> be the first line after the opening, or else PHP will throw an error.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">Helpers\Testing</span><span class="p">;</span></code></pre></div>

<p>After defining the namespace, you will most likely want to include common exceptions that will be thrown when accessing models.</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">use Illuminate\Database\Eloquent\ModelNotFoundException;</span></code></pre></div>

<p>From there, you&#39;re ready and free to define your helper class as you please. </p>

<p><strong>PLEASE COMMENT FUNCTIONS</strong></p>

<h3>Test Cases</h3>

<p>To write test cases you must extend from the Laravel&#39;s base <code>TestCase</code> class. When writing test cases please follow certain conventions:</p>

<ul>
<li>The name of the file and the class for the test case should follow the naming convention ControllerFunctionTest

<ul>
<li>Ex: Writing test cases for the Index function for the User Controller: UserControllerIndexTest.php</li>
</ul></li>
</ul>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">UserControllerIndexTest</span> <span class="k">extends</span> <span class="nx">TestCase</span> <span class="p">{</span>

<span class="p">}</span></code></pre></div>

<ul>
<li>All functions that are test musted start with the word <strong>test</strong> (PHPUnit convention) or else PHPUnit will not find your function</li>
<li>Functions should specify what role they&#39;re testing as, ex: <code>testIndexAsAdmin()</code></li>
</ul>

<h3>Tips for Writing Test Cases</h3>

<h4>Calling Routes</h4>

<p>We want to guarantee our that not only our functions are correct, but that our routes/API are calling the correct functions. If you can, please test routes rather than functions. You can call routes using the <code>$this-&gt;call()</code> function. More information for calling routes can be found in <a href="http://laravel.com/docs/testing#calling-routes-from-tests">Laravel&#39;s Documentation</a>.</p>

<h4>Acting as a User</h4>

<p>To act as a user, you can use the <code>$this-&gt;be()</code> function, which can also be found in <a href="http://laravel.com/docs/testing#helper-methods">Laravel&#39;s Documentation</a></p>

<h4>Specifying Exceptons</h4>

<p>An exception being throw can be a success if a user should not have access to certain functionality. Since our API immediately throws a InsufficientPermissionsException when a user doesn&#39;t have the right permissions, we can easily have our test cases catch this and mark them as a passed test. To specify that an exception should be thrown, you can define it in the PHPDocs comments like so:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
    <span class="k">class</span> <span class="nc">UserControllerIndexTest</span> <span class="k">extends</span> <span class="nx">TestCase</span> <span class="p">{</span>
        <span class="sd">/**</span>
<span class="sd">         * Tests user index function as student, passes on thrown exception</span>
<span class="sd">         * @expectedException InsufficientPermissionsException</span>
<span class="sd">        */</span>
        <span class="k">public</span> <span class="k">function</span> <span class="nf">testIndexAsStudent</span><span class="p">()</span> <span class="p">{</span>
            <span class="nv">$user</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">userHelper</span><span class="o">-&gt;</span><span class="na">getStudentUser</span><span class="p">();</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">be</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">call</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">base_route</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span></code></pre></div>

<h4>Writing Functions</h4>

<p><strong>Note:</strong> Only one test per function, so you cannot have a function return users with all roles and test them as one test case. Hence the need for the naming convention of what you&#39;re testing as what role.</p>

<p>Test cases can become repetitive, to ease the amount of typing you can write a function (<em>GASP!</em>) which we can call in our <del>all</del> most  of our tests. </p>

<h3>References</h3>

<ul>
<li><a href="http://laravel.com/docs/testing">Laravel Documentation on Testing</a></li>
<li><a href="http://phpunit.de/manual/current/en/index.html">PHPUnit Documentation</a></li>
</ul>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="personal">
            <p>
                <a href="http://itsbarakyo.com/personal/2013/10/21/weekly-report.html">
                    Weekly Report 10/13-10/19
                </a>
            </p>
            <small>21 Oct 2013</small>
        </blockquote>
        <p><b>Good:</b>
<div>
<ul>
    <li>Team meeting with good discussions and thoughts</li>
    <li>Completed usability requests (Thanks DUDE!)</li>
    <li>Discussions with various people regarding my thesis and some ideas</li>
    <li>Was able to find an answer to one of the problems I was having with my thesis</li>
    <li>Swam 4 times and swam my fastest 50m so far! (35 seconds)</li>
    <li>Big picture discussions about web services, API keys, improving the API</li>
    <li>Completed and demoed my project for Comp595.</li>
    <li>Began the path to more focused test driven development in our latest sprint planning</li>
    <li>Planning Poker at the sprint planning</li>
</ul>
<div><b>Areas for Improvement:</b></div>
<div>
<ul>
    <li>More efficient planning</li>
    <li>Prioritization and organization</li>
    <li>Patience
<ul>
    <li>Hard work does not go unnoticed (I hope!)</li>
</ul>
</li>
</ul>
</div>
<div><b>Thoughts:</b></div>
<div>
<ul>
    <li>Made some big decisions over the weekend testing my ability to be more decisive and I think I'm doing well.</li>
</ul>
</div>
</div></p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="personal">
            <p>
                <a href="http://itsbarakyo.com/personal/2013/09/22/weekly-report.html">
                    Weekly Report 9/15-9/21
                </a>
            </p>
            <small>22 Sep 2013</small>
        </blockquote>
        <p>My boss emails out a weekly report of all his activities every week and I thoroughly enjoy them. I'd thought I'd start writing them myself to help reflect.
<strong>Good:</strong>
<ul>
    <li>Completed notifications for RP</li>
    <li>Started working on a small email wrapper class for RP</li>
    <li>Progress on my thesis</li>
    <li>Completed section on Phoenix database's layer.</li>
    <li>Completed section on the Neo4J equivalent of EAS's database.</li>
    <li>Swam 4 times this past week!</li>
    <li>Completed and submitted Comp429's Project 1 - Yak</li>
    <li>Completed, submitted, and demoed Comp595's Project 2 - Sensor Information</li>
    <li>Discussions with coworkers
<ul>
    <li>Compilers, Interpreters, JIT compilers</li>
    <li>C
<ul>
    <li>Pointers/Arrays and Buffers</li>
    <li>Re-entrant functions</li>
    <li>Man pages</li>
</ul>
</li>
</ul>
</li>
    <li>RP pre-meeting and role reviews</li>
    <li>Revised/updated my resume</li>
    <li>Got RP running on saga28</li>
    <li>Will be helping out with my friend's robotics team at his old high school, Team4Element!</li>
    <li>Completed 2 Project Euler problems in Python!</li>
</ul>
<strong>Areas for Improvement:</strong>
<ul>
    <li>Communicating efficiently</li>
    <li>Saga28 server maintenance
<ul>
    <li>Messed up existing SSL configuration when updating Apache :/</li>
</ul>
</li>
    <li>Need to get back on my scheduled 1-on-1s</li>
    <li>Have to get back to updating my blog</li>
    <li>Organization, scheduling, and Agile</li>
    <li>Lost touch of the Agile approach since I've moved back to RP.</li>
    <li>Thesis proof-reading and progress updates with my thesis committee.</li>
    <li>Wasn't so active on IRC this past week.</li>
</ul>
<strong>Thoughts:</strong>
<ul>
    <li>Team Building
<ul>
    <li>Team4Element - Need to learn the kids and how I can help</li>
    <li>Family - Need to figure out how to help out here as well</li>
</ul>
</li>
    <li>Python-Eve Neo4J driver
<ul>
    <li>Reviewed what I could do to possibly develop a Neo4J driver for the Eve framework built on top of Flask.</li>
</ul>
</li>
</ul></p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="likes">
            <p>
                <a href="http://itsbarakyo.com/likes/2013/07/28/my-awesome-setup.html">
                    My Awesome(WM) Setup
                </a>
            </p>
            <small>28 Jul 2013</small>
        </blockquote>
        <p><p>
    <img alt="" src="http://i.imgur.com/zAJ9ZNb.png" class="img-responsive" / 
</p>

<p>
    I&#39;ve been making the switch to tiling window managers through the use of AwesomeWM. If you&#39;re not using a tiling window manager, you should definitely give it a shot! I shouldn&#39;t take all the credit though, <a href="https://github.com/copycat-killer/awesome-copycats">Copycat Killer&#39;s</a> AwesomeWM configs are a great start and essentially what allowed me to make the switch.
</p>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="projects">
            <p>
                <a href="http://itsbarakyo.com/projects/2013/05/29/python-excel-xlrd-and-xlwt.html">
                    Python-Excel: XLRD & XLWT
                </a>
            </p>
            <small>29 May 2013</small>
        </blockquote>
        <p><p>The other week we received a request for a small script from a department on campus. The department needed to evaluate data from a Microsoft Excel worksheet which they wrote a macro for. Their problem, though, was to aggregate all their data into one sheet. This aggregation process was not only the most tedious but was also their longest task taking nearly 2 weeks to complete. My coworkers and I were shocked that they&#39;ve continued this process for so long without looking to automate it somehow, so we took on the challenge to ease the pain in their lives. </p>

<p>I set out to write a Python script and immediately researched what Microsoft Excel libraries are available for Python. I quick found Python-Excel and the XLRD and XLWT libraries, which I have to say, have been nothing short but amazing to use. The libraries are intuitive and easy to use. There was not a function I could think of that this library didn&#39;t provide. The code can be found on <a href="https://github.com/barakyo/excel-extractor">GitHub</a>.</p>

<p>Just some quick examples of how I was using the libraries:</p>

<p><strong>Opening an excel file:</strong> </p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">try</span><span class="p">:</span>
    <span class="c"># Open the book</span>
    <span class="n">book</span> <span class="o">=</span> <span class="n">xlrd</span><span class="o">.</span><span class="n">open_workbook</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;File: &quot;</span> <span class="o">+</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s">&quot; does not exist&quot;</span><span class="p">)</span></code></pre></div>

<p><strong>Opening a specific sheet:</strong></p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Try to open the specific sheet</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">summary_sheet</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">sheet_by_name</span><span class="p">(</span><span class="s">&#39;For Summary File&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&#39;Could not open sheet &#39;</span> <span class="o">+</span> <span class="n">sheet_name</span> <span class="o">+</span> <span class="s">&#39; in file &#39;</span> <span class="o">+</span> <span class="n">file_name</span><span class="p">)</span></code></pre></div>

<p><strong>Copying a row:</strong></p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">summary_sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">summary_sheet</span><span class="o">.</span><span class="n">ncols</span><span class="p">)]</span></code></pre></div>

<p><strong>Creating a new workbook and sheet:</strong></p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Create a new workbook</span>
<span class="n">new_workbook</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Workbook</span><span class="p">()</span>
<span class="c"># Create a new sheet</span>
<span class="n">new_sheet</span> <span class="o">=</span> <span class="n">new_workbook</span><span class="o">.</span><span class="n">add_sheet</span><span class="p">(</span><span class="s">&#39;Sheet1&#39;</span><span class="p">)</span></code></pre></div>

<p><strong>Writing data to the new workbook:</strong></p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Write the data to the sheet</span>
<span class="n">new_sheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">current_row</span><span class="p">[</span><span class="n">col</span><span class="p">])</span></code></pre></div>

<p><strong>Saving a workbook:</strong></p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">new_workbook</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span></code></pre></div>

<p>Doesn&#39;t get much simpler than that! :)</p>
</p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="likes">
            <p>
                <a href="http://itsbarakyo.com/likes/2013/05/29/kippt.html">
                    Kippt
                </a>
            </p>
            <small>29 May 2013</small>
        </blockquote>
        <p><p>
    It seemed to be happening more often than usual. I&#39;d have something cool to share but no one was on messenger/IRC/Facebook/Google+/etc. What good are all these social networks if its so difficult to just share the latest JS plugin I saw on Reddit/Github? Going back over my options, I thought maybe I could just drop my friends an email, but the more I thought about it, emails can be annoying and are typically dismissed. If I&#39;m going to take the time to share something, I want someone to see it!&nbsp;I needed a good way to be able to share links,&nbsp;update those that want to see it without annoying them, and have these links be accessible anywhere. In steps Kippt. Kippt is social bookmarking taken to the next level. My coworkers and I can now share links easily right through a browser extension and can be notified based on how we want. We&#39;ve been using Kippt for about a month and a half now and its been an integral part of the way we work, learn, and share.
</p>

<p>
    If you&#39;re on Kippt, follow me and I&#39;ll follow you back: <a href="https://kippt.com/barakyo">Barakyo</a>
</p>

<p>
    If you&#39;re not on Kippt, I highly recommend getting&nbsp;on, following people (and me if you want!)
</p></p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="projects">
            <p>
                <a href="http://itsbarakyo.com/projects/2013/02/03/my-first-jquery-plugin-selectall.html">
                    My first jQuery Plugin--SelectAll
                </a>
            </p>
            <small>03 Feb 2013</small>
        </blockquote>
        <p><p>
    Refactoring code has been on my mind more lately than usual. I feel that if I&#39;m not actively thinking and keeping in mind of what I&#39;m coding, that I&#39;m bound to rewrite code I&#39;ve already written elsewhere. While working on Gavel&#39;s &quot;Manage&quot; page (still thinking of a clever title for that page), I realized that I had a set of checkboxes that I needed to keep track of for both my labels tab and my events tab. I wrote some small Javascript code to handle keeping track of labels as well as select/deselect all checkboxes, but when I started the events section, I realize that I didn&#39;t want to have to rewrite all this code. A lightbulb went off in my head and rather than googling for a jQuery plugin, I decided to challenge myself and write my own, so I present <a href="https://github.com/barakyo/selectall" target="_blank">jQuery Select All</a>. The plugin will take checkboxes as an input and keep track of them in an array. An optional select/deselect all can be passed in with the allSelector parameter. I&#39;m sure this has been written already, but it was a good challenge for myself to think abstractly. Go check it out and fork me if you want!
</p></p>
        <hr />
    </div>
</div>
    
        <div class="row">
    <div class="col-sm-12">
        <blockquote class="likes">
            <p>
                <a href="http://itsbarakyo.com/likes/2013/02/02/get-in-get-happy.html">
                    Get In. Get Happy
                </a>
            </p>
            <small>02 Feb 2013</small>
        </blockquote>
        <p><iframe width="500" height="281" src="http://www.youtube.com/embed/9H0xPWAtaa8?feature=oembed" frameborder="0" allowfullscreen></iframe>
<p>
    Love this commercial and the feel good mood!
</p></p>
        <hr />
    </div>
</div>
    
</div>
</body>
</html>